<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Python Notes | Zach's Blog</title>
<meta name=keywords content="Python,Hugo"><meta name=description content="I use this blog to check if this websites works well with contents in Chinese."><meta name=author content="Zhu Yiming"><link rel=canonical href=https://zhuyimingg.github.io/posts/python-notes/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://zhuyimingg.github.io/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zhuyimingg.github.io/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zhuyimingg.github.io/images/favicon-32x32.png><link rel=apple-touch-icon href=https://zhuyimingg.github.io/apple-touch-icon.png><link rel=mask-icon href=https://zhuyimingg.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://zhuyimingg.github.io/posts/python-notes/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Python Notes"><meta property="og:description" content="I use this blog to check if this websites works well with contents in Chinese."><meta property="og:type" content="article"><meta property="og:url" content="https://zhuyimingg.github.io/posts/python-notes/"><meta property="og:image" content="https://zhuyimingg.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-01T20:17:36+08:00"><meta property="article:modified_time" content="2024-07-01T20:17:36+08:00"><meta property="og:site_name" content="Zach's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zhuyimingg.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Python Notes"><meta name=twitter:description content="I use this blog to check if this websites works well with contents in Chinese."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://zhuyimingg.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Python Notes","item":"https://zhuyimingg.github.io/posts/python-notes/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Python Notes","name":"Python Notes","description":"I use this blog to check if this websites works well with contents in Chinese.","keywords":["Python","Hugo"],"articleBody":"Link of the Lectures\nDay1 Python Syntax 注释 提高代码可读性和开发效率；进行代码调试问题排查。\n快捷键CTRL+/ 单行注释，‘’‘或“”“多行注释，编码注释(python2)。\n变量与数据类型 变量是一段有名字的连续存储空间。 (tuple) [list] {dict} 命名规范：见名知义，小驼峰式userName，大驼峰式UserName，下划线式user_name。\n运算符 %mod//floor 优先级()-\u003enot-\u003eand-\u003eor\n输入与输出 name = 'Lee' age = 20 # %s %d %f: 's' indicates String print('My name is %s, I am %s. '%(name, age)) print('My name is {}, I am {}'.format(name, age)) # {:\u003e3}表示右对齐(^表示居中)，占用三个字符，{:.3}表示保留小数点后三位 input()默认将输入储存为str类型\nDay2 Judgement and Loop 选择流程 if elif else pass空语句(alternative)\n循环流程 while for print(..., end='')可以取消换行，end default = ‘\\n’。\nbreak退出整个循环，continue跳过本次循环。\n# If we break the loop, else statement will not be excuted. for item in range(10): print(item, end=' ') if item \u003e= 5: break pass else: print('no break excuted.') Day3 Str List Tuple Dict 字符串 序列的共同特点：支持索引与切片操作。 .capitalize() .strip()去除首位的空格 .lstrip() .rstrip() .find()没找到返回’-1’ .index()没找到报异常 .startswith() .endswith() .lower() .upper()\n列表 list = [0] * length # 创建一个长度为length的0元素列表 del list[start:stop] # 删除指定索引的数据 a = list.index(1) # 返回元素对应的索引 元组 Tuple is immutable(只能进行查询操作)！但是元组中储存的列表是mutable的。当元组只有一个元素时也应加上’, ‘，否则会被当做整形处理，元组同样支持切片操作tuple[start:stop:step]。\n字典 字典以{'key':'value'}的形式组成的集合，通过键来进行访问，字典是无序的键值集合，每个键值对用’, ‘分割。键必须是immutable类型(tuple/str)，而值可以是任何类型。\ndictA = {'ID':887} dictA['name'] = 'Zach' # 增加新的元素 dictA['age'] = 20 # \u003e\u003e\u003e print dictA # {'ID': 887, 'name': 'Zach', 'age': 20} # \u003e\u003e\u003e len(dictA) # 3 dictA['age'] = 21 # 修改字典内的元素 dictA.update({'height':1.9}) # 可以新增或修改已有 print(dictA.keys()) # 获取所有键组成的列表 print(dictA.values()) # 获取所有值组成的列表 for key, value in dictA.items(): print('%s---%s'%(key, value)) del dictA['name'] dictA.pop('age') 字典可以进行排序：\nprint(sorted(dictA.items(), key=lambda d:d[0])) #按key排序 print(sorted(dictA.items(), key=lambda d:d[1])) #按value排序 共有操作 +拼接操作 *复制操作 in对象是否存在(dict默认判断key)\nDay4 Function Ⅰ 函数定义 函数的说明文档：\ndef factorial(n): ''' This function is used to calculate factorials :param n: order of the factorial :return: answer ''' if n == 0: result = 1 else: result = n * factorial(n-1) return result help(factorial) # 获取函数的说明文档 函数参数 默认参数应当位于参数列表的尾部；可变参数接受的是一个元组类型：\ndef cal(*args): ''' 这个函数用于计算可变长序列的和 :param args: 可变长的参数类型 :return: ''' result = 0 for item in args: result += item return result print(cal(1, 2, 3)) 关键字可变参数由’**‘来定义，是一个字典类型，且key是一个字符串：\ndef keyFunc(**kwargs): print(kwarg) dictA = {'name':'zach', 'age':20} keyFunc(**dictA) keyFunc(name='peter', age=22) # 混合使用，可选参数必须放在关键字可变参数之前 def complexFunc(*args, **kwargs): print(args) print(kwargs) complexFunc(1, 2, 3, name='zach') Day5 Function Ⅱ 全局变量与局部变量 要在函数内修改全局变量，则需要使用global关键字进行声明。\n函数参数调用传值 在函数调用时，实参传递的是一个数据对象的引用。基于此原理，我们可以去把控函数内部的操作是否会影响全局变量的值：当传递的是一个不可变对象(immutable，如int/float/tuple/str)引用时，内部操作不会影响值；而当传递的是可变对象(mutable，如list/set/dict)引用时，内部操作会影响值(不会产生一个新的对象去指向)。\n匿名函数 Python中使用lambda关键字创建匿名函数，所谓匿名即函数没有名字且不需用def关键字创建。冒号后的表达式有且只有一个，返回值即表达式的计算结果。匿名函数是为了适应简单逻辑、简单函数的简洁性。\n# lambda param1, param2, ...: operations test = lambda x,y: x+y print(test(1, 3)) # 通过变量名调用匿名函数 test1 = lambda x,y: x if x\u003ey else y rs = (lambda x,y: x if x\u003ey else y)(16, 10) print(test1(1, 3)) print(r, s) 递归Recursion import os def findFile(file_path): ''' 递归查找directory下的所有文件名 :param file_path: directory的路径 :return: ''' listRs = os.listdir(file_path) for fileItem in listRs: full_path = os.path.join(file_path, fileItem) if os.path.isdir(full_path): findFile(full_path) else: print(fileItem) findFile('D:\\文件\\大四上\\夏令营材料') Day6 Python Built-in Function 常用数学运算 abs() round(3.66, 1) pow() divmod() max() min() sum(iterable, start) eval()用于执行一个字符串表达式并返回值(动态执行)\n# eval(expression[, globals[, locals]]) \u003e\u003e\u003e a, b, c = 1, 2, 3 \u003e\u003e\u003e eval('a+b+c') 6 def TestFun(): print('Something') eval('TestFun()') 类型转换函数 bin() hex() chr() bytes(‘str’, encoding=‘utf-8’)\n序列操作 all()：判断iterable中所有元素是否都为True(元素除了0/None/False都算作True)，空列表和空元组也返回为True。\nany()：有一项True则返回True。\nsort()是应用在list对象上的方法，是在已存在的列表上进行操作；而sorted()方法可以对所有iterable对象进行排序，且返回一个新的序列。\nlist.sort(key=None, reverse=False) # 默认为升序 sorted(list, key=None, reverse=False) \u003e\u003e\u003e li = ['E', 'a', 'W', 'b'] \u003e\u003e\u003e sorted(li, key=str.lower) # 字符串无关大小写排序 ['a', 'b', 'E', 'W'] list.reverse() range(start, stop, step) enumerate(list/dictObj[, start=0])\nzip()函数用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回由这些元组组成的列表。在 Python 3.x 中为了减少内存，zip()返回的是一个对象。如需展示列表，需手动 list()转换，并且可以进一步用dict()转换为字典。\n# zip([iterable, ...]) \u003e\u003e\u003e a = [1,2,3] \u003e\u003e\u003e b = [4,5,6] \u003e\u003e\u003e c = [4,5,6,7,8] \u003e\u003e\u003e zipped = zip(a,b) # 返回一个对象 \u003e\u003e\u003e zipped \u003czip object at 0x103abc288\u003e \u003e\u003e\u003e list(zipped) # list()转换为列表 [(1, 4), (2, 5), (3, 6)] \u003e\u003e\u003e list(zip(a,c)) # 元素个数与最短的列表一致 [(1, 4), (2, 5), (3, 6)] \u003e\u003e\u003e a1, a2 = zip(*zip(a,b)) # 与zip相反，zip(*)可理解为解压，返回二维矩阵式 \u003e\u003e\u003e list(a1) [1, 2, 3] \u003e\u003e\u003e list(a2) [4, 5, 6] 集合set 不支持索引，是一个无序且不重复的容器。\nset1 = {1, 2, 3} \u003e\u003e\u003e set1.add('python') \u003e\u003e\u003e set1.clear() set2 = {2, 3, 4} \u003e\u003e\u003e set1.difference(set2) or set1 - set2 # 取差 {1} \u003e\u003e\u003e set1 # 操作后set1不发生改变 {1, 2, 3} \u003e\u003e\u003e set1.intersection(set2) or set1 \u0026 set2 # 取交 {2, 3} \u003e\u003e\u003e set1.union(set2) or set1 | set2 # 取并 {1, 2, 3, 4} \u003e\u003e\u003e set1.discard(2) # 删除指定元素 \u003e\u003e\u003e set1 {1, 3} \u003e\u003e\u003e set1.update(set2) \u003e\u003e\u003e set1 {1, 2, 3, 4} Day7 Object-Oriented Programming Ⅰ 类和对象 类(Class): 用来描述具有相同的属性和方法的对象的集合。它定义了该集合中每个对象所共有的属性和方法。对象是类的实例。 **对象：**通过类定义的数据结构实例。对象包括两个数据成员（类变量和实例变量）和方法。 实例方法和属性 **实例方法：**在类的内部由def关键字定义的方法，第一个参数默认是self（可以更换名字标识，但位置必须被占用）\n**属性：**定义在类里面，方法之外的称之为类属性，定义在方法里面，使用self引用的属性称为实例属性。\n魔法方法 __init__ __str__ __new__ __class__\nclass Mode: ... def __str__(self): return 'str{}'.format() # 自定义对象转换为字符串的方式 \u003e\u003e\u003e m = Mode() \u003e\u003e\u003e print(m) 真正实例化过程中，先被调用的是__new__函数，返回一个对象实例供__init__函数进行初始化。\nDay8 Object-Oriented Programming Ⅱ 析构方法 __del__析构函数，程序执行结束时自动调用以释放对象，手动清楚对象(del)时也会调用。\n单继承 在python中展示面向对象的三大特征：封装、继承和多态。封装指使用初始化构造方法将内容封装到对象中，然后通过对象或者self获取被封装的内容。继承则是指子类可以继承父类的属性和方法。\n多继承 class C(A, B):可以实现对多个父类的类属性与方法的继承。C.__mro__可以显示类的依次继承关系，进而可以得知父类中有同名方法或属性时，调用的优先级顺序。\n调用父类的方法 子类中与父类同名的方法会覆盖掉父类的方法，称为重写父类方法。利用super()方法可以调用父类的属性或方法。\nclass Dog: def __init__(self, name): ... class Corgi(Dog): def __init__(self, name, height): super().__init__(name) # Dog.__init__(name)效果相同 self._height = height 多态 多态指同一种行为对于不同的子类/对象具有不同的行为表现。多态的两个前提：继承，多态必须发生在父类和子类之间；重写，子类对父类方法进行重写。多态可以增加程序的灵活性和扩展性，事实上，只要有同名属性或方法，不论是否从同一父类继承而来(比如再定义一个People-\u003eStudent，同样具有say_who()方法)，那么也可以统一进行调用。即Python是一种弱类型语言，本身就支持多态，这也称为“鸭子类型”(Duck Typing，走起来像鸭子、游起来像鸭子，属性和方法都像鸭子，那么就可以当作鸭子)。\ndef commonInvoke(obj): obj.say_who() # saywho()方法在不同子类中得到重写 li_obj = [Duck(), Dog(), Student()] # 从Animal父类继承的不同子类 for item in li_obj: commonInvoke(item) 类名.类属性名和实例对象名.类属性名都可以访问类属性。\n类方法和静态方法 类方法即类对象拥有的方法，需要用装饰器@classmethod来标识其为类方法，对于类方法，第一个参数必须是类对象(cls)。类方法可以通过类对象和实例对象调用。同名称的实例属性和类属性，实例属性的优先级最高。\n静态方法也是类对象拥有的方法，需要用@staticmethod来标识，静态方法不需要任何参数，可以但不必使用实例对象调用(静态方法与类和实例对象没有交互，不会涉及到类中方法与属性的操作，因此主要用于存放逻辑性的代码)，这样可以节省资源利用。\nimport time class TimeShow: @staticmethod def showTime(): return time.ctime() #获取当前时间，以易读形式 pass pass \u003e\u003e\u003e print(TimeShow.showTime()) Mon Nov 7 19:36:17 2022 Day9 Object-Oriented Programming Ⅲ 私有化属性和方法 __attributeName声明该属性为私有化属性，不能在类的外部被使用或直接访问，子类不能继承父类的私有化属性。\n有些重要的方法，不允许外部调用，防止子类意外重写，就把普通方法设置成私有化方法。私有化方法由def __methodName():语句进行定义。\n_attributeName表示protected类型的变量，即保护类型只能允许其本身与子类进行访问，不能用from module import attribute的方式导入。\n事实上，这并不会阻止实例变量访问或修改实例。仍然可以执行以下操作：\nclass Student: def __init__(self, name, age): self._name = name self._age = age \u003e\u003e\u003e za = Student('Zach', 20) \u003e\u003e\u003e print(za._age) 20 但是可以使用Property属性装饰器定义属性，使其受到保护。本质上是避免再使用_age这个变量，转而使用za.age。\nProperty属性函数 用Property属性函数访问私有属性。\n方法一 class Person: def __init__(self): self.__age = 18 def get_age(self): return self.__age def set_age(self, age): self.__age = age # 定义一个类属性，实现通过访问该属性的形式去访问私有的属性，本质上还是通过函数来调用 age = property(get_age, set_age) 方法二 class Person: def __init__(self): self.__age = 18 @property # 用装饰器修饰，提供一个getter方法 def age(self): return self.__age @age.setter # 提供一个setter方法 def age(self, params): self.__age = params \u003e\u003e\u003e p1 = Person() \u003e\u003e\u003e print(p1.age) # 本质上还是通过函数来访问私有属性 \u003e\u003e\u003e p1.age = 25 \u003e\u003e\u003e print(p1.age) 18 25 __new__方法 __new__是在一个对象实例化时调用的第一个方法，创建并返回一个实例对象，继承自object的新式类才有这一魔法方法。\n__new__至少必须要有一个参数cls，代表要实例化的类。__new__决定是否要使用该__init__方法，因为__new__可以调用其他类的构造方法或者直接返回别的实例对象来作为本类的实例对象，如果__new__没有返回实例对象，则__init__不会被调用。\nclass Animal: def __init__(self): self.color = 'orange' # 若不重写__new__方法的默认结构如下 def __new__(cls, *args, **kwargs): return super().__new__(cls, *args, **kwargs) 在__new__方法中不能够调用自己的__new__方法，即return cls.__new__(cls)是不可行的。\n单例模式 单例模式是一种常用的软件设计模式，目的是确保一个类只有一个实例存在。单例模式可以基于__new__方法实现。\nclass DataBaseClass(object): def __new__(cls, *args, **kwargs): cls._instance = super().__new__(cls, *args, **kwargs) return cls._instance pass \u003e\u003e\u003e db1 = DataBaseClass() \u003e\u003e\u003e print(id(db1)) \u003e\u003e\u003e db2 = DataBaseClass() \u003e\u003e\u003e print(id(db2)) 2685817195016 2685817195208 # 创建了两个实例对象，因此其地址不同 增加一个判断实现单例模式：\nclass DataBaseClass(object): def __new__(cls, *args, **kwargs): if not hasattr(cls, '_instance'): cls._instance = super().__new__(cls, *args, **kwargs) return cls._instance # 如果已经实例化过，直接返回第一次的实例化对象 pass \u003e\u003e\u003e db1 = DataBaseClass() \u003e\u003e\u003e print(id(db1)) \u003e\u003e\u003e db2 = DataBaseClass() \u003e\u003e\u003e print(id(db2)) 2018812627592 2018812627592 # 只创建了一次实例对象 如果子类继承父类并且不改写__new__方法，则子类也保持单例模式。\nclass SingleCase(object): __instance = None # 储存唯一实例化对象 __hasInit = False # 标记是否进行初始化 def __init__(self, age): if not SingleCase.__hasInit: self.age = age SingleCase.__hasInit = True def __new__(cls, *args, **kwargs): if not cls.__instance: cls.__instance = super().__new__(cls) return cls.__instance \u003e\u003e\u003e obj1 = SingleCase(18) \u003e\u003e\u003e obj2 = SingleCase(20) \u003e\u003e\u003e print(id(obj1)) \u003e\u003e\u003e print(id(obj2)) \u003e\u003e\u003e print(obj1.age) \u003e\u003e\u003e print(obj2.age) 2152476593352 2152476593352 18 18 # 实际上是同一对象 单例模式的应用场景：日志插入logger的操作，网站计数器，权限验证模块，Windows资源管理器，系统回收站，数据库连接池等。\n错误与异常处理 except在捕获异常时，要根据具体的错误类型。不需要在每一个可能出错的地方进行捕获，只要在合适的层次捕获即可，这一可以大大减少写try-except语句的麻烦。\ntry: # 可能出现错误的代码块 except IndexError as ei: print(ei) # 出错后执行的代码块 except ZeroDivisionError as ez: print(ez) # 出错后执行的代码块 except Exception as msg: # 异常类型不确定时，Exception可以捕获所有类型异常 print(msg) ... else: # 没有出错时执行的代码块 finally: # 不论是否出错都执行的代码块 其实python的解释器在抛出异常后，虽然整个程序终止，但是会有错误信息的提示和跟踪信息，从上到下对应了错误发生的层次顺序（错误的堆栈），根据这个跟踪信息顺序可以发现问题所在。\n自定义异常 自定义异常都要直接或间接继承Error或Exception类。\nclass MyException(Exception): def __init__(self, len): self._len = len def __str__(self): return 'Exception: Input with {}, too long!'.format(self._len) def username(): name = input('Input username (less than 6 characters)... ') try: if len(name) \u003e 6: raise MyException(len(name)) else: print(name) except MyException as e: print(e) finally: print('Program finished...') \u003e\u003e\u003e username() Input username (less than 6 characters)... zachzhu Exception: Input with 7, too long! Program finished... 动态绑定属性与方法 动态语言即运行时可以改变结构的语言，例如增加新的函数、对象甚至代码，已有的函数可以被删除或是做其他结构上的改变。PHP、JavaScript和Python都是动态语言，而C、C#和Java是静态语言。因此Python可以在程序运行过程中添加属性和方法。\n动态添加方法 动态添加实例方法需要引入types库：\nimport types def dynamic_method(self): print('{} is from {}.'.format(self.name, Student.school) # 类的定义... za = Student('Zach', 20) Student.school = 'Hust' # 动态绑定类属性 za.print_info = types.MethodType(dynamic_method, za) # 动态方法的绑定 za.print_info() # 调用绑定的动态方法 绑定类方法(静态方法同理)：\n@classmethod def class_test(cls): print('This is a class method.') Student.test_method = class_test Student.test_method() __slots__属性 Python是动态语言，在运行时可以动态添加属性。如果要限制在运行时给类添加属性，Python允许在定义class的时候，定义一个特殊的__slots__变量，来限制该class实例能添加的属性。只有在__slots__变量中的属性才能被添加。__slots__属性子类不会继承，只有在当前类中有效，但是当子类声明__slots__时，其范围是子类加父类。比如__slots__ = ()表示直接继承父类属性。\nclass Student(object): __slots__ = ('name', 'age') za = Student() za.name = 'Zach' za.age = 20 \u003e\u003e\u003e za.score = 100 AttributeError: 'Student' object has no attribute 'score' 不定义__slots__变量时，所有的属性都会储存在za.__dict__属性当中，不足之处在于占用内存较大，而定义了__slots__之后，实例中不存在__dict__属性。因此__slots__属性可以节约内存空间。\nDay10 OOP Project Day11 File Operations And Modules 文件读写 在Python中打开文件使用open函数，可以打开一个已经存在的文件，或者创建一个新文件，其语法格式为open('filename', 'mode')。\nfile_obj = open('./Python_review/test.txt', 'w', encoding='utf-8') # './'表示在当前目录下 file_obj.write('hate it...') file_obj.close() ‘w’模式每次会创建新文件，如果文件已存在则会将其覆盖，‘a’模式表示在已存在文件的末尾追加。注意有中文的时候一定要说明编码方式，否则容易乱码/报错，VsCode Python的默认编码是utf-8(窗口右下角可调…)，编码方式在open语句中以encoding=属性进行设置。\n‘wb’表示以二进制格式打开一个文件用于写入：\nfile_obj = open('./Python_review/test.txt', 'wb') file_obj.write('hate it...'.encode('utf-8')) # 将str类型转换为一个bytes类型 file_obj.close() 二进制读写时要特别注意编码问题，应当在写入时做'string'.encode('utf-8')处理，而在读取时做(fileObject.read()).decode('utf-8')处理。\n文件的读取：\nf = open('./Python_review/test.txt', 'r') print(f.read()) # 读取整个文件 \u003e\u003e\u003e print(f.read(4)) # 读取4个字符，并将光标移动到读取的末尾，下次读取会从此继续 hell f.close() # 对文件和内存的安全非常必要 .readline()一次读取一行数据，以\\n结尾；.readlines()读取整个文件返回一个列表，列表元素对应每一行的内容。\n可以用with语句管理文件对象，可以自动释放打开关联的对象，可以免去.close()语句。\nwith open('./Python_review/test.txt', 'a') as f: f.write('\\nPython Done Wrong') r/w适用于普通的读/写场景；+代表打开一个文件进行更新(可读可写)；w/w+/wb+每次都会创建一个新的文件，目录相同时则替换原文件；b代表二进制读写，rb/rb+适用于图片、音频、视频等类别的文件读取；a/ab/a+在原有文件的基础之后去文件指针的末尾进行追加。\n文件读写的应用实例 def copy_file(): # 对原文件进行备份 fileName = input('Input original filename: ') temp = fileName.split('.') copyName = temp[0] + '_copy.' + temp[1] of = open(fileName, 'r', encoding='utf-8') cf = open(copyName, 'w', encoding='utf-8') # 注意有中文的时候一定要说明编码方式，否则容易报错 content = of.read() cf.write(content) of.close() cf.close() \u003e\u003e\u003e copy_file() Type in the original filename: \u003e\u003e\u003e Python_review\\test.txt 处理超大文件时，一次将全部内容读出会占据大量的内存，因此针对大文件读取可以做出以下改进：\ndef copy_file(): fileName = input('Input original filename: ') temp = fileName.split('.') copyName = temp[0] + '_copy.' + temp[1] try: with open(fileName, 'r', encoding='utf-8') as of, \\ open(copyName, 'a', encoding='utf-8') as cf: # space+\\换行符 while True: content = of.read(1024) cf.write(content) if len(content) \u003c 1024: break except Exception as e: print(e) 文件定位 文件定位指当前文件指针读取到的位置，可以使用.tell()方法来实现。utf-8编码中一个中文字符占3个字节，一个换行符占2个字节，因此.tell()方法返回的位置是3×中文字符数，2×换行符。\nfileObject.truncate([size])从文件的首行首字符开始截断，截断文件为size个字节，无size表示从当前位置截断；截断之后后面的所有字符被删除，其中windows系统下的换行代表2个字节大小。测试了一下，似乎.read()按照open()语句中的打开模式操作，‘b’二进制模式下按照字节数操作，否则按字符数操作；而.truncate()始终按字节数进行操作。\n在操作文件的过程中，如果需要定位到其他位置进行操作，用.seek()方法。fileObject.seek(offset[, whence])有两个参数：\noffset：开始的偏移量，也就是代表需要移动偏移的字节数，如果是负数表示从倒数第几位开始。 whence：可选，默认值为0。给offset定义一个参数，表示要从哪个位置开始偏移；0代表从文件开头开始算起，1代表从当前位置开始算起，2代表从文件末尾算起。没有使用’b’二进制选项打开时，只允许从文件的开头计算。 综上，文件定位的函数都是基于字节数进行的操作，进行文件定位操作时最好使用’b’二进制读写模式。\n模块导入方式 Python有强大的第三方库，提供很多常用功能内置模块。简单来说模块就是封装了许多函数的.py文件。在程序中需要用到模块需先将模块导入。模块导入格式import ModuleName，函数调用格式ModuleName.function_name()。\n当解释器遇到import关键字时，会优先搜索当前目录下；若当前目录下不存在时，则会到环境变量中搜索；环境变量中不存在时会在第三方模块安装位置'C:\\Program Files\\Python37\\Lib\\site-packages'中搜索。可以使用sys模块中的path变量查看搜索路径。\nfrom time import ctime # 从模块中导入函数 ctime() # 无需模块名前缀 可以用import ModuleName as ...语句，自定义程序中指向模块名称空间的变量。\nos模块操作文件 import os # 基本目录操作，新建、删除、重命名 os.rename('test.txt', 'test_rename.txt') os.remove('test.txt') os.mkdir('os_test') # 在当前位置创建目录 os.rmdir('os_test') # 只能删除空目录 # 删除非空目录需要导入shutil.remove() os.mkdir('d:/test') os.mkdir('d:/test/Sub') # 一次只能创建一级目录 os.makedirs('d:/test1/ha') # 可以创建多级 # 目录获取与拼接 \u003e\u003e\u003e os.getcwd() # 获取当前的目录 C:\\Users\\12035\\VScodeProjects \u003e\u003e\u003e os.path.join(os.getcwd(), 'Python_review') # 路径的拼接 C:\\Users\\12035\\VScodeProjects\\Python_review # 目录列表的获取 # 方法1 listD = os.listdir('d:/') # 取出该位置所有目录名储存在列表中 for dirName in listD: print(dirName) # 方法2 with os.scandir('d:/') as entries: # 用with语句，在完成迭代后自动释放资源 for entry in entries: print(entry.name) 文件操作的综合运用见Day5 Function Ⅱ \u003e 递归函数。\n模块的制作 在Python中一个.py文件即是一个模块。模块可以是我们有逻辑地去组织Python代码，以库的形式去封装功能，方便使用者调用。\n当Module中含有函数外的语句时，被导入时也会被运行，因此可以借助魔术变量__name__解决这个问题。当模块自身被运行时__name__为 '__main__'，而被导入时为模块名，因此可以在模块中的测试语句前加入判断语句if __name__ == '__main__':，那么模块被导入时测试语句不会被运行。\n模块中__all__魔术变量限定from ModuleName import *导入方式时可以导入的方法。使用格式为__all__ = ['functionName1', 'functionName2', ...]。\n模块的发布 将写好的模块拉到一个单独的目录下，在该目录下建立一个setup.py文件： from distutils.core import setup # name模块名称 # version版本号 # description描述 # author作者 # py_modules要发布的内容 setup(name='Arith', version='1.0', description='simple arithmetic operations', author='Zach', py_modules=['arithmetic']) 在Terminal下使用cd命令进入新建的目录(使用dir命令可以查看当前的目录)，使用python setup.py build命令创建模块，此时会自动生成一个build文件夹，里面的lib文件夹会存放模块的.py文件。\n仍然在当前新建目录的路径下面，使用命令：python setup.py sdist生成模块的压缩包，压缩包的名字是setup.py文件中的name名字；可以在当前路径下使用tree命令查看目录和目录结构，压缩包存放在自动生成的dist文件夹中。\nPS C:\\Users\\12035\\VScodeProjects\u003e cd Arith PS C:\\Users\\12035\\VScodeProjects\\Arith\u003e python ... PS C:\\Users\\12035\\VScodeProjects\\Arith\u003e python setup.py sdist ... 模块的安装 将压缩生成的’.tar.gz’文件复制到需要的目录下，然后在Terminal进入该目录，用pip install ModuleName语句即可安装。\nPS C:\\Users\\12035\\VScodeProjects\u003e d: PS D:\\\u003e dir ... PS D:\\\u003e pip install Arith-1.0.tar.gz Day12 Python Garbage Collection 电脑运行变慢时可以关闭不用的程序、结束部分进程或重启电脑，但是重启电脑的效果最为明显，这说明其他方法并不能完全释放内存资源，而垃圾回收就是使程序尽可能完全地释放内存资源。\n引用计数机制 高级语言如Java，C#等都采用了垃圾收集机制。Python采用的是引用计数机制为主，标记-清除和分代收集两种机制为辅的策略。 Python中每个东西都是对象，其核心就是一个结构体：PyObject，PyObject中的ob_refcnt就是作为引用计数，当引用计数为0时，该对象生命就结束了。\nimport sys a = [] \u003e\u003e\u003e sys.getrefcount(a) # 在调用后会释放引用 2 b = a \u003e\u003e\u003e sys.getrefcount(a) 3 标记-清除机制 首先标记对象（垃圾检测），然后清除垃圾（垃圾回收）。初始所有对象标记为白色，并确定根节点（这些对象是不会删除的），标记为黑色；将有效对象引用的对象标记为灰色，表示对象可达，但其引用的对象还未检查；检查完灰色都西昂引用的对象后其标记为黑色。重复该过程直到没有灰色节点为止。最后白色节点需要被清除。\n分代收集机制 循环引用的情况难以被引用计数机制解决，因此需要其他GC机制。\nimport sys import psutil import os import gc def show_mem(tag): pid = os.getpid() # 得到进程id p = psutil.Process(pid) # 得到进程对象 info = p.memory_full_info() # 得到完整内存信息 memory = info.uss/1024/1024 print('{} memory used: {}MB'.format(tag, memory)) def func(): show_mem('initial') a = [0] * 100000 b = [0] * 100000 a.append(b) b.append(a) # 循环引用 # print(sys.getrefcount(a)) # print(sys.getrefcount(b)) show_mem('after creating a b') # del a # del b # 函数调用结束后相当于运行了以上语句，但引用始终不为0 \u003e\u003e\u003e func() \u003e\u003e\u003e show_mem('function ends') initial memory used: 6.2109375MB 3 3 after creating a b memory used: 21.52734375MB function ends memory used: 21.52734375MB \u003e\u003e\u003e func() \u003e\u003e\u003e gc.collect() # 手动释放内存 \u003e\u003e\u003e show_mem('function ends') initial memory used: 6.2578125MB 3 3 after creating a b memory used: 21.5859375MB function ends memory used: 6.28515625MB 由于循环引用，并且程序使用了一些比其他对象存在更久的对象，从而被分配对象的计数值与被释放对象的计数值差异累积超过某个GC阈值，此时Python的收集机制就启动了，触发所谓零代算法。 零代算法：Python使用一种不同的链表来持续追踪活跃的对象，每创建一个对象时Python将其加入零代链表，Generation Zero；Python循环遍历零代链表上的每个对象检查其相互引用情况，依据规则减掉引用计数，引用计数为0的对象可以被释放，而不为0则代表着其正在被零代链表之外的对象引用，即其相对活跃；剩下的活跃对象被移动到新的链表，一代链表；一代链表中对象的处理方式同理。 通过这种方法，持续访问的活跃对象会从零代链表到一代再到二代，而所谓的浮动垃圾则会每隔一段时间被处理。\nPython中的GC模块 当gc模块的计数器达到阈值时，会自动回收垃圾（除非使用gc.disable()关闭gc模块功能）；gc.collect()可以手动回收垃圾；程序退出时，python解释器会自动回收垃圾。\ngc.get_count()可以获取一个长度为3的列表的计数器，例如(200, 8, 3)，200表示距离上一次一代垃圾检查，python分配内存数目减去释放内存的数目；8是指距离上一次二代垃圾检查，一代垃圾检查的次数，3同理。gc.get_threshold()可以获取分带收集机制的GC阈值。\nPython的小整数与大整数对象池：Python为了避免整数频繁申请和销毁内存空间，[-5, 256]这些整数对象是提前建立好的，不会被垃圾回收。\nPython PEP8规范 每一行的最大长度为79，换行可以使用space+\\，圆括号内则不需要换行符。文本长块，如文档字符串或注释的行长度应限制为72个字符。\n模块名要简短，使用小写字母，下划线提高可读性；包名和模块名类似，但不推荐下划线。类名称通常使用大驼峰命名方式。实例方法总是用self作为第一个参数，类方法总是用cls作为第一个参数。函数名和实例变量使用小写字母，下划线分隔提高可读性。\n命令行参数 在使用Python开发脚本，作为一个运维工具，或者其他工具需要用户参数运行时，可以用到命令行传参的方式。Python可以用sys模块中的sys.argv获取命令行参数。argv返回的第一个元素为py文件的文件名（包含完整路径），不需文件名可直接使用切片[1:]。\nargparse模块可以轻松编写用户友好的命令行界面：\nimport argparse # 创建一个解析器对象 # prog -- The name of the program (default: sys.argv[0]) # usage -- A usage message (default: auto-generated from arguments) # description -- A description of what the program does # epilog -- Text following the argument descriptions parser = argparse.ArgumentParser(prog='my-program', usage='%(prog)s [options] usage', description='my-description', epilog='my-epilog') # 添加位置参数(必选参数) parser.add_argument('name', type=str, help='your own name') parser.add_argument('age', type=int, help='your age') # 添加可选参数 parser.add_argument('-g', '--gender', type=str, help='your sexuality') # 可以增加属性action='append'，则可以从命令行重复定义该参数，变量空间中以列表储存 # 可以增加属性default='Male'指定默认值，choices=['Male', 'Female']限定参数的范围 # 开始解析参数并打印 result = parser.parse_args() print(result) # 可以通过result.name...访问具体的变量 # 直接在Terminal进行如下操作 \u003e\u003e\u003e PS C:\\Users\\12035\\VScodeProjects\u003e python c:/Users/12035/VScodeProjects/Python_review/sys_test.py Zach 20 -g Male Namespace(age=20, gender='Male', name='Zach') \u003e\u003e\u003e PS C:\\Users\\12035\\VScodeProjects\u003e python c:/Users/12035/VScodeProjects/Python_review/sys_test.py -h usage: my-program [options] usage my-description positional arguments: name your own name age your age optional arguments: -h, --help show this help message and exit -g GENDER, --gender GENDER your sexuality my-epilog Day13 Python Regular Expression 正则表达式概述 正则表达式是一个特殊的字符序列，它能帮助你方便的检查一个字符串是否与某种模式匹配。Python自1.5版本起增加了re模块，它提供Perl风格的正则表达式模式。re模块使Python语言拥有全部的正则表达式功能。compile函数根据一个模式字符串和可选的标志参数生成一个正则表达式对象。该对象拥有一系列方法用于正则表达式匹配和替换。re模块也提供了与这些方法功能完全一致的函数，这些函数使用一个模式字符串做为它们的第一个参数。\nPython re模块 re.match(pattern, string, flags=0)尝试从字符串的起始位置匹配一个规则，匹配成功就返回match对象，否则返回None。可以用group()获取匹配成功的字符串。pattern-匹配的正则表达式，string-要匹配的字符串，flag-标志位，用于控制正则表达式的匹配方式，如是否区分大小写、多行匹配等。\nimport re str = 'Python makes me happy~' # 精确匹配，且只匹配字符串的开头位置 result = re.match('python', str, re.I) # 此处可以是.match('p'...)/.macth('P'...) \u003e\u003e\u003e result.group() 'P' flag可选的标志符：re.I-使匹配对大小写不敏感，re.M-多行匹配，影响^和$，如果使用多个标志位用|分隔，如re.I|re.M。\n使用group(num)或groups()匹配对象函数来获取匹配表达式。group(num=0)返回匹配的整个表达式的字符串，可以一次输入多个组号，在这种情况下将返回一个包含那些组所对应值的元组。groups()返回一个包含所有小组字符串的元组，从1到所含的小组号。\nimport re str = 'Python is the best language in the world' # .* 表示任意匹配除换行符（\\n、\\r）之外的任何单个或多个字符 # (.*?) 表示\"非贪婪\"模式，只保存第一个匹配到的子串 result = re.match('(.*) is (.*?) .*', str, re.M|re.I) if result: print(result) print(result.group()) print(result.group(1)) print(result.group(2)) print(result.groups()) else: print('No match!') \u003cre.Match object; span=(0, 40), match='Python is the best language in the world'\u003e Python is the best language in the world Python the ('Python', 'the') 常用匹配规则 .的使用：\nimport re line = 'aaaa' names = '李敏', '李达', '小李' # 一个'.'匹配除去换行符'\\n'之外的一个字符 pattern = '..' pattern1 = '李.' res = re.match(pattern, line) if res: print(res.group()) else: print('No match!') for name in names: res1 = re.match(pattern1, name) if res1: print(res1.group(), end=' ') aa 李敏 李达 []的使用：\nimport re str = 'echo' # 使用中括号表示一个集合，匹配集合内的任一字符 # matchObject = re.match('[ace]', str) # 匹配字母a c e matchObject = re.match('[a-e]', str) # 匹配字母a到e if matchObject: print(matchObject.group()) else: print('No match!') e Pattern Description \\d 匹配任意一位数字，相当于’[0-9]’ \\d’*num 匹配前num位数字 \\D 匹配任意一位非数字 \\s 匹配任意一个空白字符或tab键 等价于 [\\t\\n\\r\\f] \\S 匹配任意非空字符 \\w 匹配数字字母下划线 \\W 匹配非数字字母下划线 匹配字符数量 import re # *表示匹配前一个字符出现0次或无限次，即可有可无 res = re.match('[A-Z][A-Z]*', 'Ay') print(res.group()) # A res = re.match('[A-Z][a-z]*', 'AnythingYouKnow') print(res.group()) # Anything # +表示匹配前一个字符至少出现一次 res = re.match('[A-Z]+', 'MYname') print(res.group()) # MY # 匹配符合python变量命名规范的字符串(不能以数字开头，只包含数字字母下划线) res = re.match('[a-zA-Z_]+[\\w]*', '_name11') print(res.group()) # _name11 # ?表示匹配前一个字符出现1次或0次，即要么有要么没有 res = re.match('[a-zA-Z_]+\\d?', 'name11') print(res.group()) # name1 # {min,max}表示匹配前一个字符次数范围 res = re.match('\\d{4}', '11230') print(res.group()) # 1123 res = re.match('\\d{4,}', '11230') print(res.group()) # 11230 # 匹配邮箱 res = re.match('[a-zA-Z0-9]{6,11}@gmail.com', 'zachary99@gmail.com') print(res.group()) # zachary99@gmail.com 转义、开头和结尾 python字符串中\\作为转义字符开头，比如\\t表示tab键，\\n表示换行，为了表示'\\'本身，比如在打印路径时应再加一个\\形成'\\\\'的形式。\nmyPath = 'G:\\py_note\\1-syntax' print(myPath) # G:\\py_note-syntax myPath = 'G:\\\\py_note\\\\1-syntax' print(myPath) # G:\\py_note\\1-syntax 正则表达式中的\\也需要转移，因此为匹配并输出正确的路径，应当为\\\\载进行转义。也可以通过在pattern前加上r表示原生字符串直接匹配，不进行转义。\nimport re print(re.match('c:\\\\\\\\a.txt', 'c:\\\\a.txt').group()) # c:\\a.txt print(re.match(r'c:\\\\a.txt', 'c:\\\\a.txt').group()) # c:\\a.txt 字符串开头结尾的匹配：\nimport re # ^表示匹配字符串的开头 res = re.match('^P.*', 'Python done right.') print(res.group()) # Python done right. res = re.match('^P\\w{5}', 'Python done right.') print(res.group()) # Python # $表示匹配字符串的结尾 res = re.match('\\w{5,15}@\\w{2,6}.com$', '1203524576@qq.com') print(res.group()) # 1203524576@qq.com 分组匹配 import re # |表示匹配左右任意一个表达式 res = re.match('100|[1-9]\\d?', '100') # 100需放在前面，否则匹配出10，或改用表达式'[1-9]?\\d$|100' print(res.group()) # 100 # ()表示将字符作为一个分组 res = re.match('(\\d+)-(\\d+)', '027-82411110') # 匹配带区号的电话号码 # 或使用表达式'([^-]+)-(\\d+)'，在[]中^表示取反，即不是^的字符 print(res.group()) print(res.group(1)) print(res.group(2)) # 027-82411110 # 027 # 82411110 # \\num表示引用分组num匹配到的字符 htmlTag = 'test' res = re.match(r'\u003c(.+)\u003e\u003c(.+)\u003e(.+)\u003c/\\2\u003e\u003c/\\1\u003e', htmlTag) print(res.group(1)) print(res.group(2)) print(res.group(3)) # html # h1 # test # 分组过多时可读性差，可以使用分组别名(?P...)和(?P=name) htmlTag = 'www.google.com' res = re.match(r'\u003c(?P\\w*)\u003e\u003c(?P\\w*)\u003e(.+)\u003c/(?P=n2)\u003e\u003c/(?P=n1)\u003e', htmlTag) print(res.group(1)) print(res.group(2)) print(res.group(3)) # div # h1 # www.google.com re中的其他方法 每次使用正则表达式进行match操作时，python会进行一次字符串转为正则表达式对象的操作。而进行**re.compile()**将正则表达式模式编译成一个正则表达式对象，其保存所产生的正则表达式对象重用效率更高。\nimport re reObj = re.compile('\\d{4}') # reObj可重用 res = reObj.match('12306') print(res.group()) # 1230 re.search()在全文中匹配一次，匹配到就返回。\nimport re line = 'Python done right.' res = re.search('done', line) print(res.group()) # done re.findall()匹配所有返回一个列表(查询正则表达式)。\nimport re line = '西瓜和冬瓜' res = re.findall('.瓜', line) print(res) # ['西瓜', '冬瓜'] reObj = re.compile('.瓜') # 创建对象便于复用 print(reObj.search(line).group()) print(reObj.findall(line)) 使用re.findall()函数时要活用'()'，输出需要的内容：\nimport re line = 'Truman ShowAvatarLa La Land' reObject = re.compile(r'(.+?)') result = reObject.findall(line) print(result) # ['Truman Show', 'Avatar', 'La La Land'] re.sub(pattern, repl, string, count=0, flags=0)将匹配到的数据进行替换。count为匹配后替换的最大次数，默认0表示替换所有，flags为正则表达式匹配方式的标志位。\nimport re line = 'Python是很受欢迎的语言.' pattern = '[a-zA-Z]+' res = re.sub(pattern, 'C#', line) res_n = re.subn(pattern, 'C#', line) # 返回替换次数 print(res) print(res_n) # C#是很受欢迎的语言. # ('C#是很受欢迎的语言.', 1) re.split()：\nimport re line = 'watermelon melon water' res = re.split(' ', line) print(res) # ['watermelon', 'melon', 'water'] 贪婪模式与非贪婪模式 Python里的数量词默认是贪婪的，即总是尝试匹配尽可能多的字符，非贪婪模式则相反，总是尝试匹配尽可能少的字符。在*?+{m,n}后面加上?使贪婪模式变为非贪婪。\nimport re # 默认贪婪模式 print(re.match('\\d{6,9}', '1234567890').group()) # 加?变为非贪婪模式 print(re.match('\\d{6,9}?', '1234567890').group()) # 123456789 # 123456 line = 'aacbacbc' reObject = re.compile('a.*b') res = reObject.search(line) print(res.group()) # aacbacb reObject = re.compile('a.*?b') # 加?变为非贪婪模式 res = reObject.search(line) print(res.group()) # aacb ","wordCount":"2288","inLanguage":"en","image":"https://zhuyimingg.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-07-01T20:17:36+08:00","dateModified":"2024-07-01T20:17:36+08:00","author":[{"@type":"Person","name":"Zhu Yiming"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhuyimingg.github.io/posts/python-notes/"},"publisher":{"@type":"Organization","name":"Zach's Blog","logo":{"@type":"ImageObject","url":"https://zhuyimingg.github.io/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://zhuyimingg.github.io/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://zhuyimingg.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://zhuyimingg.github.io/tags/ title=Tag><span>Tag</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zhuyimingg.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://zhuyimingg.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Python Notes</h1><div class=post-description>I use this blog to check if this websites works well with contents in Chinese.</div><div class=post-meta><span title='2024-07-01 20:17:36 +0800 CST'>July 1, 2024</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;2288 words&nbsp;·&nbsp;Zhu Yiming</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#day1-python-syntax>Day1 Python Syntax</a></li><li><a href=#day2-judgement-and-loop>Day2 Judgement and Loop</a></li><li><a href=#day3-str-list-tuple-dict>Day3 Str List Tuple Dict</a></li><li><a href=#day4-function->Day4 Function Ⅰ</a></li><li><a href=#day5-function->Day5 Function Ⅱ</a></li><li><a href=#day6-python-built-in-function>Day6 Python Built-in Function</a></li><li><a href=#day7-object-oriented-programming->Day7 Object-Oriented Programming Ⅰ</a></li><li><a href=#day8-object-oriented-programming->Day8 Object-Oriented Programming Ⅱ</a></li><li><a href=#day9-object-oriented-programming->Day9 Object-Oriented Programming Ⅲ</a></li><li><a href=#day10-oop-project>Day10 OOP Project</a></li><li><a href=#day11-file-operations-and-modules>Day11 File Operations And Modules</a></li><li><a href=#day12-python-garbage-collection>Day12 Python Garbage Collection</a></li><li><a href=#day13-python-regular-expression>Day13 Python Regular Expression</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><a href=https://www.bilibili.com/video/BV1vA411b7Rn/>Link of the Lectures</a></p><h3 id=day1-python-syntax>Day1 Python Syntax<a hidden class=anchor aria-hidden=true href=#day1-python-syntax>#</a></h3><h4 id=注释>注释<a hidden class=anchor aria-hidden=true href=#注释>#</a></h4><p>提高代码可读性和开发效率；进行代码调试问题排查。</p><p>快捷键CTRL+/ 单行注释，‘’‘或“”“多行注释，编码注释(python2)。</p><h4 id=变量与数据类型>变量与数据类型<a hidden class=anchor aria-hidden=true href=#变量与数据类型>#</a></h4><p>变量是一段有名字的连续存储空间。
(tuple) [list] {dict}
命名规范：见名知义，小驼峰式userName，大驼峰式UserName，下划线式user_name。</p><h4 id=运算符>运算符<a hidden class=anchor aria-hidden=true href=#运算符>#</a></h4><p>%mod//floor
优先级()->not->and->or</p><h4 id=输入与输出>输入与输出<a hidden class=anchor aria-hidden=true href=#输入与输出>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Lee&#39;</span>
</span></span><span class=line><span class=cl><span class=n>age</span> <span class=o>=</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=c1># %s %d %f: &#39;s&#39; indicates String</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;My name is </span><span class=si>%s</span><span class=s1>, I am </span><span class=si>%s</span><span class=s1>. &#39;</span><span class=o>%</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>age</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;My name is </span><span class=si>{}</span><span class=s1>, I am </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>age</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># {:&gt;3}表示右对齐(^表示居中)，占用三个字符，{:.3}表示保留小数点后三位</span>
</span></span></code></pre></div><p>input()默认将输入储存为str类型</p><h3 id=day2-judgement-and-loop>Day2 Judgement and Loop<a hidden class=anchor aria-hidden=true href=#day2-judgement-and-loop>#</a></h3><h4 id=选择流程-if-elif-else>选择流程 if elif else<a hidden class=anchor aria-hidden=true href=#选择流程-if-elif-else>#</a></h4><p>pass空语句(alternative)</p><h4 id=循环流程-while-for>循环流程 while for<a hidden class=anchor aria-hidden=true href=#循环流程-while-for>#</a></h4><p><code>print(..., end='')</code>可以取消换行，end default = &lsquo;\n&rsquo;。</p><p>break退出整个循环，continue跳过本次循环。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># If we break the loop, else statement will not be excuted.</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>item</span> <span class=o>&gt;=</span> <span class=mi>5</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;no break excuted.&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=day3-str-list-tuple-dict>Day3 Str List Tuple Dict<a hidden class=anchor aria-hidden=true href=#day3-str-list-tuple-dict>#</a></h3><h4 id=字符串>字符串<a hidden class=anchor aria-hidden=true href=#字符串>#</a></h4><p>序列的共同特点：支持索引与切片操作。
.capitalize() .strip()去除首位的空格 .lstrip() .rstrip() .find()没找到返回’-1’ .index()没找到报异常 .startswith() .endswith() .lower() .upper()</p><h4 id=列表>列表<a hidden class=anchor aria-hidden=true href=#列表>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>list</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>length</span>   <span class=c1># 创建一个长度为length的0元素列表</span>
</span></span><span class=line><span class=cl><span class=k>del</span> <span class=nb>list</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>stop</span><span class=p>]</span>  <span class=c1># 删除指定索引的数据</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=nb>list</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>     <span class=c1># 返回元素对应的索引</span>
</span></span></code></pre></div><h4 id=元组>元组<a hidden class=anchor aria-hidden=true href=#元组>#</a></h4><p>Tuple is immutable(只能进行查询操作)！但是元组中储存的列表是mutable的。当元组只有一个元素时也应加上&rsquo;, &lsquo;，否则会被当做整形处理，元组同样支持切片操作<code>tuple[start:stop:step]</code>。</p><h4 id=字典>字典<a hidden class=anchor aria-hidden=true href=#字典>#</a></h4><p>字典以<code>{'key':'value'}</code>的形式组成的集合，通过键来进行访问，字典是无序的键值集合，每个键值对用&rsquo;, &lsquo;分割。键必须是immutable类型(tuple/str)，而值可以是任何类型。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>dictA</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;ID&#39;</span><span class=p>:</span><span class=mi>887</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>dictA</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;Zach&#39;</span>        <span class=c1># 增加新的元素</span>
</span></span><span class=line><span class=cl><span class=n>dictA</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=c1># &gt;&gt;&gt; print dictA</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;ID&#39;: 887, &#39;name&#39;: &#39;Zach&#39;, &#39;age&#39;: 20}</span>
</span></span><span class=line><span class=cl><span class=c1># &gt;&gt;&gt; len(dictA)</span>
</span></span><span class=line><span class=cl><span class=c1># 3</span>
</span></span><span class=line><span class=cl><span class=n>dictA</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>21</span>             <span class=c1># 修改字典内的元素</span>
</span></span><span class=line><span class=cl><span class=n>dictA</span><span class=o>.</span><span class=n>update</span><span class=p>({</span><span class=s1>&#39;height&#39;</span><span class=p>:</span><span class=mf>1.9</span><span class=p>})</span>  <span class=c1># 可以新增或修改已有</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>dictA</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>           <span class=c1># 获取所有键组成的列表</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>dictA</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>         <span class=c1># 获取所有值组成的列表</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>dictA</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>%s</span><span class=s1>---</span><span class=si>%s</span><span class=s1>&#39;</span><span class=o>%</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>del</span> <span class=n>dictA</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>dictA</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s1>&#39;age&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>字典可以进行排序：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>sorted</span><span class=p>(</span><span class=n>dictA</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=n>d</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>  <span class=c1>#按key排序</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>sorted</span><span class=p>(</span><span class=n>dictA</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=n>d</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>  <span class=c1>#按value排序</span>
</span></span></code></pre></div><h4 id=共有操作>共有操作<a hidden class=anchor aria-hidden=true href=#共有操作>#</a></h4><p>+拼接操作 *复制操作 in对象是否存在(dict默认判断key)</p><h3 id=day4-function->Day4 Function Ⅰ<a hidden class=anchor aria-hidden=true href=#day4-function->#</a></h3><h4 id=函数定义>函数定义<a hidden class=anchor aria-hidden=true href=#函数定义>#</a></h4><p>函数的说明文档：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>factorial</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>    This function is used to calculate factorials
</span></span></span><span class=line><span class=cl><span class=s1>    :param n: order of the factorial
</span></span></span><span class=line><span class=cl><span class=s1>    :return: answer
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>n</span> <span class=o>*</span> <span class=n>factorial</span><span class=p>(</span><span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>help</span><span class=p>(</span><span class=n>factorial</span><span class=p>)</span>   <span class=c1># 获取函数的说明文档</span>
</span></span></code></pre></div><h4 id=函数参数>函数参数<a hidden class=anchor aria-hidden=true href=#函数参数>#</a></h4><p>默认参数应当位于参数列表的尾部；可变参数接受的是一个元组类型：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>cal</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>    这个函数用于计算可变长序列的和
</span></span></span><span class=line><span class=cl><span class=s1>    :param args: 可变长的参数类型
</span></span></span><span class=line><span class=cl><span class=s1>    :return:
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>args</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>+=</span> <span class=n>item</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>cal</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>
</span></span></code></pre></div><p>关键字可变参数由’**‘来定义，是一个字典类型，且key是一个字符串：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>keyFunc</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>kwarg</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>dictA</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span><span class=s1>&#39;zach&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span><span class=mi>20</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>keyFunc</span><span class=p>(</span><span class=o>**</span><span class=n>dictA</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>keyFunc</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;peter&#39;</span><span class=p>,</span> <span class=n>age</span><span class=o>=</span><span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 混合使用，可选参数必须放在关键字可变参数之前</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>complexFunc</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>complexFunc</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;zach&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=day5-function->Day5 Function Ⅱ<a hidden class=anchor aria-hidden=true href=#day5-function->#</a></h3><h4 id=全局变量与局部变量>全局变量与局部变量<a hidden class=anchor aria-hidden=true href=#全局变量与局部变量>#</a></h4><p>要在函数内<strong>修改</strong>全局变量，则需要使用<code>global</code>关键字进行声明。</p><h4 id=函数参数调用传值>函数参数调用传值<a hidden class=anchor aria-hidden=true href=#函数参数调用传值>#</a></h4><p>在函数调用时，实参传递的是一个<strong>数据对象的引用</strong>。基于此原理，我们可以去把控函数内部的操作是否会影响全局变量的值：当传递的是一个不可变对象(immutable，如int/float/tuple/str)引用时，内部操作不会影响值；而当传递的是可变对象(mutable，如list/set/dict)引用时，内部操作会影响值(不会产生一个新的对象去指向)。</p><h4 id=匿名函数>匿名函数<a hidden class=anchor aria-hidden=true href=#匿名函数>#</a></h4><p>Python中使用<code>lambda</code>关键字创建匿名函数，所谓匿名即函数没有名字且不需用<code>def</code>关键字创建。冒号后的表达式有且只有一个，返回值即表达式的计算结果。匿名函数是为了适应简单逻辑、简单函数的简洁性。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># lambda param1, param2, ...: operations</span>
</span></span><span class=line><span class=cl><span class=n>test</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>:</span> <span class=n>x</span><span class=o>+</span><span class=n>y</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>test</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>        <span class=c1># 通过变量名调用匿名函数</span>
</span></span><span class=line><span class=cl><span class=n>test1</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>:</span> <span class=n>x</span> <span class=k>if</span> <span class=n>x</span><span class=o>&gt;</span><span class=n>y</span> <span class=k>else</span> <span class=n>y</span>
</span></span><span class=line><span class=cl><span class=n>rs</span> <span class=o>=</span> <span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>:</span> <span class=n>x</span> <span class=k>if</span> <span class=n>x</span><span class=o>&gt;</span><span class=n>y</span> <span class=k>else</span> <span class=n>y</span><span class=p>)(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>test1</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=递归recursion>递归Recursion<a hidden class=anchor aria-hidden=true href=#递归recursion>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>findFile</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>    递归查找directory下的所有文件名
</span></span></span><span class=line><span class=cl><span class=s1>    :param file_path: directory的路径
</span></span></span><span class=line><span class=cl><span class=s1>    :return:
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>listRs</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>fileItem</span> <span class=ow>in</span> <span class=n>listRs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>full_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>fileItem</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>full_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>findFile</span><span class=p>(</span><span class=n>full_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>fileItem</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>findFile</span><span class=p>(</span><span class=s1>&#39;D:\文件\大四上\夏令营材料&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=day6-python-built-in-function>Day6 Python Built-in Function<a hidden class=anchor aria-hidden=true href=#day6-python-built-in-function>#</a></h3><h4 id=常用数学运算>常用数学运算<a hidden class=anchor aria-hidden=true href=#常用数学运算>#</a></h4><p>abs() round(3.66, 1) pow() divmod() max() min() sum(iterable, start) eval()用于执行一个字符串表达式并返回值(动态执行)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># eval(expression[, globals[, locals]])</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>eval</span><span class=p>(</span><span class=s1>&#39;a+b+c&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>TestFun</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Something&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>eval</span><span class=p>(</span><span class=s1>&#39;TestFun()&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=类型转换函数>类型转换函数<a hidden class=anchor aria-hidden=true href=#类型转换函数>#</a></h4><p>bin() hex() chr() bytes(&lsquo;str&rsquo;, encoding=&lsquo;utf-8&rsquo;)</p><h4 id=序列操作>序列操作<a hidden class=anchor aria-hidden=true href=#序列操作>#</a></h4><p>all()：判断iterable中所有元素是否都为True(元素除了0/None/False都算作True)，空列表和空元组也返回为True。</p><p>any()：有一项True则返回True。</p><p>sort()是应用在list对象上的方法，是在已存在的列表上进行操作；而sorted()方法可以对所有iterable对象进行排序，且返回一个新的序列。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>list</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>     <span class=c1># 默认为升序</span>
</span></span><span class=line><span class=cl><span class=nb>sorted</span><span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>li</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;E&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;W&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>li</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=nb>str</span><span class=o>.</span><span class=n>lower</span><span class=p>)</span>          <span class=c1># 字符串无关大小写排序</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;E&#39;</span><span class=p>,</span> <span class=s1>&#39;W&#39;</span><span class=p>]</span>
</span></span></code></pre></div><p>list.reverse() range(start, stop, step) enumerate(list/dictObj[, start=0])</p><p>zip()函数用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回由这些元组组成的列表。在 Python 3.x 中为了减少内存，zip()返回的是一个对象。如需展示列表，需手动 list()转换，并且可以进一步用dict()转换为字典。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># zip([iterable, ...])</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>b</span> <span class=o>=</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>c</span> <span class=o>=</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>zipped</span> <span class=o>=</span> <span class=nb>zip</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>     <span class=c1># 返回一个对象</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>zipped</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nb>zip</span> <span class=nb>object</span> <span class=n>at</span> <span class=mh>0x103abc288</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>list</span><span class=p>(</span><span class=n>zipped</span><span class=p>)</span>          <span class=c1># list()转换为列表</span>
</span></span><span class=line><span class=cl><span class=p>[(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>),</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>list</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>c</span><span class=p>))</span>        <span class=c1># 元素个数与最短的列表一致</span>
</span></span><span class=line><span class=cl><span class=p>[(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>),</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>a1</span><span class=p>,</span> <span class=n>a2</span> <span class=o>=</span> <span class=nb>zip</span><span class=p>(</span><span class=o>*</span><span class=nb>zip</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>))</span>     
</span></span><span class=line><span class=cl><span class=c1># 与zip相反，zip(*)可理解为解压，返回二维矩阵式</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>list</span><span class=p>(</span><span class=n>a1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>list</span><span class=p>(</span><span class=n>a2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
</span></span></code></pre></div><h4 id=集合set>集合set<a hidden class=anchor aria-hidden=true href=#集合set>#</a></h4><p>不支持索引，是一个无序且不重复的容器。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>set1</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>set1</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=s1>&#39;python&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>set1</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>set2</span> <span class=o>=</span> <span class=p>{</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>set1</span><span class=o>.</span><span class=n>difference</span><span class=p>(</span><span class=n>set2</span><span class=p>)</span> <span class=ow>or</span> <span class=n>set1</span> <span class=o>-</span> <span class=n>set2</span>     <span class=c1># 取差</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=mi>1</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>set1</span>                      <span class=c1># 操作后set1不发生改变</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>set1</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=n>set2</span><span class=p>)</span> <span class=ow>or</span> <span class=n>set1</span> <span class=o>&amp;</span> <span class=n>set2</span>   <span class=c1># 取交</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>set1</span><span class=o>.</span><span class=n>union</span><span class=p>(</span><span class=n>set2</span><span class=p>)</span> <span class=ow>or</span> <span class=n>set1</span> <span class=o>|</span> <span class=n>set2</span>          <span class=c1># 取并</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>set1</span><span class=o>.</span><span class=n>discard</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>           <span class=c1># 删除指定元素</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>set1</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>set1</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>set2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>set1</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>}</span>
</span></span></code></pre></div><h3 id=day7-object-oriented-programming->Day7 Object-Oriented Programming Ⅰ<a hidden class=anchor aria-hidden=true href=#day7-object-oriented-programming->#</a></h3><h4 id=类和对象>类和对象<a hidden class=anchor aria-hidden=true href=#类和对象>#</a></h4><ul><li><strong>类(Class):</strong> 用来描述具有相同的<strong>属性</strong>和<strong>方法</strong>的对象的集合。它定义了该集合中每个对象所共有的属性和方法。对象是类的实例。</li><li>**对象：**通过类定义的数据结构实例。对象包括两个数据成员（类变量和实例变量）和方法。</li></ul><h4 id=实例方法和属性>实例方法和属性<a hidden class=anchor aria-hidden=true href=#实例方法和属性>#</a></h4><ul><li><p>**实例方法：**在类的内部由<code>def</code>关键字定义的方法，第一个参数默认是<code>self</code>（可以更换名字标识，但位置必须被占用）</p></li><li><p>**属性：**定义在类里面，方法之外的称之为类属性，定义在方法里面，使用<code>self</code>引用的属性称为实例属性。</p></li></ul><h4 id=魔法方法>魔法方法<a hidden class=anchor aria-hidden=true href=#魔法方法>#</a></h4><p><code>__init__</code> <code>__str__</code> <code>__new__</code> <code>__class__</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Mode</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;str</span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>()</span>   <span class=c1># 自定义对象转换为字符串的方式</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>m</span> <span class=o>=</span> <span class=n>Mode</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</span></span></code></pre></div><p>真正实例化过程中，先被调用的是<code>__new__</code>函数，返回一个对象实例供<code>__init__</code>函数进行初始化。</p><h3 id=day8-object-oriented-programming->Day8 Object-Oriented Programming Ⅱ<a hidden class=anchor aria-hidden=true href=#day8-object-oriented-programming->#</a></h3><h4 id=析构方法>析构方法<a hidden class=anchor aria-hidden=true href=#析构方法>#</a></h4><p><code>__del__</code>析构函数，程序执行结束时自动调用以释放对象，手动清楚对象(del)时也会调用。</p><h4 id=单继承>单继承<a hidden class=anchor aria-hidden=true href=#单继承>#</a></h4><p>在python中展示面向对象的三大特征：<strong>封装、继承和多态</strong>。封装指使用初始化构造方法将内容封装到对象中，然后通过对象或者<code>self</code>获取被封装的内容。继承则是指子类可以继承父类的属性和方法。</p><h4 id=多继承>多继承<a hidden class=anchor aria-hidden=true href=#多继承>#</a></h4><p><code>class C(A, B):</code>可以实现对多个父类的类属性与方法的继承。<code>C.__mro__</code>可以显示类的依次继承关系，进而可以得知父类中有同名方法或属性时，调用的优先级顺序。</p><h4 id=调用父类的方法>调用父类的方法<a hidden class=anchor aria-hidden=true href=#调用父类的方法>#</a></h4><p>子类中与父类同名的方法会覆盖掉父类的方法，称为<strong>重写</strong>父类方法。利用<code>super()</code>方法可以调用父类的属性或方法。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Dog</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Corgi</span><span class=p>(</span><span class=n>Dog</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>height</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># Dog.__init__(name)效果相同</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_height</span> <span class=o>=</span> <span class=n>height</span>   
</span></span></code></pre></div><h4 id=多态>多态<a hidden class=anchor aria-hidden=true href=#多态>#</a></h4><p>多态指同一种行为对于不同的子类/对象具有不同的行为表现。多态的两个前提：继承，多态必须发生在父类和子类之间；重写，子类对父类方法进行重写。多态可以增加程序的灵活性和扩展性，事实上，只要有同名属性或方法，不论是否从同一父类继承而来(比如再定义一个People->Student，同样具有say_who()方法)，那么也可以统一进行调用。即Python是一种弱类型语言，本身就支持多态，这也称为“鸭子类型”(Duck Typing，走起来像鸭子、游起来像鸭子，属性和方法都像鸭子，那么就可以当作鸭子)。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>commonInvoke</span><span class=p>(</span><span class=n>obj</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>obj</span><span class=o>.</span><span class=n>say_who</span><span class=p>()</span>              <span class=c1># saywho()方法在不同子类中得到重写</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>li_obj</span> <span class=o>=</span> <span class=p>[</span><span class=n>Duck</span><span class=p>(),</span> <span class=n>Dog</span><span class=p>(),</span> <span class=n>Student</span><span class=p>()]</span>  <span class=c1># 从Animal父类继承的不同子类</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>li_obj</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>commonInvoke</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span></span></code></pre></div><p><code>类名.类属性名</code>和<code>实例对象名.类属性名</code>都可以访问类属性。</p><h4 id=类方法和静态方法>类方法和静态方法<a hidden class=anchor aria-hidden=true href=#类方法和静态方法>#</a></h4><p>类方法即类对象拥有的方法，需要用装饰器<code>@classmethod</code>来标识其为类方法，对于类方法，第一个参数必须是类对象(<code>cls</code>)。类方法可以通过类对象和实例对象调用。同名称的实例属性和类属性，实例属性的优先级最高。</p><p>静态方法也是类对象拥有的方法，需要用<code>@staticmethod</code>来标识，静态方法不需要任何参数，可以但不必使用实例对象调用(静态方法与类和实例对象没有交互，不会涉及到类中方法与属性的操作，因此主要用于存放逻辑性的代码)，这样可以节省资源利用。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TimeShow</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>showTime</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>time</span><span class=o>.</span><span class=n>ctime</span><span class=p>()</span> <span class=c1>#获取当前时间，以易读形式</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl><span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>TimeShow</span><span class=o>.</span><span class=n>showTime</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>Mon</span> <span class=n>Nov</span>  <span class=mi>7</span> <span class=mi>19</span><span class=p>:</span><span class=mi>36</span><span class=p>:</span><span class=mi>17</span> <span class=mi>2022</span>
</span></span></code></pre></div><h3 id=day9-object-oriented-programming->Day9 Object-Oriented Programming Ⅲ<a hidden class=anchor aria-hidden=true href=#day9-object-oriented-programming->#</a></h3><h4 id=私有化属性和方法>私有化属性和方法<a hidden class=anchor aria-hidden=true href=#私有化属性和方法>#</a></h4><p><code>__attributeName</code>声明该属性为<strong>私有化属性</strong>，不能在类的外部被使用或直接访问，子类不能继承父类的私有化属性。</p><p>有些重要的方法，不允许外部调用，防止子类意外重写，就把普通方法设置成私有化方法。私有化方法由<code>def __methodName():</code>语句进行定义。</p><p><code>_attributeName</code>表示protected类型的变量，即保护类型只能允许其本身与子类进行访问，不能用<code>from module import attribute</code>的方式导入。</p><p>事实上，这并不会阻止实例变量访问或修改实例。仍然可以执行以下操作：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Student</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>age</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_age</span> <span class=o>=</span> <span class=n>age</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>za</span> <span class=o>=</span> <span class=n>Student</span><span class=p>(</span><span class=s1>&#39;Zach&#39;</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>za</span><span class=o>.</span><span class=n>_age</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>20</span>
</span></span></code></pre></div><p>但是可以使用Property属性装饰器定义属性，使其受到保护。本质上是避免再使用<code>_age</code>这个变量，转而使用<code>za.age</code>。</p><h4 id=property属性函数>Property属性函数<a hidden class=anchor aria-hidden=true href=#property属性函数>#</a></h4><p>用Property属性函数访问私有属性。</p><ul><li>方法一</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Person</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>__age</span> <span class=o>=</span> <span class=mi>18</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_age</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>__age</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>set_age</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>age</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>__age</span> <span class=o>=</span> <span class=n>age</span>
</span></span><span class=line><span class=cl>    <span class=c1># 定义一个类属性，实现通过访问该属性的形式去访问私有的属性，本质上还是通过函数来调用</span>
</span></span><span class=line><span class=cl>    <span class=n>age</span> <span class=o>=</span> <span class=nb>property</span><span class=p>(</span><span class=n>get_age</span><span class=p>,</span> <span class=n>set_age</span><span class=p>)</span>
</span></span></code></pre></div><ul><li>方法二</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Person</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>__age</span> <span class=o>=</span> <span class=mi>18</span>
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>       <span class=c1># 用装饰器修饰，提供一个getter方法</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>age</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>__age</span>
</span></span><span class=line><span class=cl>    <span class=nd>@age.setter</span>     <span class=c1># 提供一个setter方法</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>age</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>__age</span> <span class=o>=</span> <span class=n>params</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>p1</span> <span class=o>=</span> <span class=n>Person</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>p1</span><span class=o>.</span><span class=n>age</span><span class=p>)</span>    <span class=c1># 本质上还是通过函数来访问私有属性</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>p1</span><span class=o>.</span><span class=n>age</span> <span class=o>=</span> <span class=mi>25</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>p1</span><span class=o>.</span><span class=n>age</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>18</span>
</span></span><span class=line><span class=cl><span class=mi>25</span>
</span></span></code></pre></div><h4 id=__new__方法><code>__new__</code>方法<a hidden class=anchor aria-hidden=true href=#__new__方法>#</a></h4><p><code>__new__</code>是在一个对象实例化时调用的第一个方法，创建并返回一个实例对象，继承自object的新式类才有这一魔法方法。</p><p><code>__new__</code>至少必须要有一个参数<code>cls</code>，代表要实例化的类。<code>__new__</code>决定是否要使用该<code>__init__</code>方法，因为<code>__new__</code>可以调用其他类的构造方法或者直接返回别的实例对象来作为本类的实例对象，如果<code>__new__</code>没有返回实例对象，则<code>__init__</code>不会被调用。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Animal</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>color</span> <span class=o>=</span> <span class=s1>&#39;orange&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 若不重写__new__方法的默认结构如下</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span></code></pre></div><p>在<code>__new__</code>方法中不能够调用自己的<code>__new__</code>方法，即<code>return cls.__new__(cls)</code>是不可行的。</p><h4 id=单例模式>单例模式<a hidden class=anchor aria-hidden=true href=#单例模式>#</a></h4><p>单例模式是一种常用的软件设计模式，目的是确保一个类只有一个实例存在。单例模式可以基于<code>__new__</code>方法实现。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>DataBaseClass</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>cls</span><span class=o>.</span><span class=n>_instance</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instance</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>db1</span> <span class=o>=</span> <span class=n>DataBaseClass</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=nb>id</span><span class=p>(</span><span class=n>db1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>db2</span> <span class=o>=</span> <span class=n>DataBaseClass</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=nb>id</span><span class=p>(</span><span class=n>db2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=mi>2685817195016</span>
</span></span><span class=line><span class=cl><span class=mi>2685817195208</span>     <span class=c1># 创建了两个实例对象，因此其地址不同</span>
</span></span></code></pre></div><p>增加一个判断实现单例模式：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>DataBaseClass</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=s1>&#39;_instance&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=bp>cls</span><span class=o>.</span><span class=n>_instance</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instance</span>    <span class=c1># 如果已经实例化过，直接返回第一次的实例化对象</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>db1</span> <span class=o>=</span> <span class=n>DataBaseClass</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=nb>id</span><span class=p>(</span><span class=n>db1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>db2</span> <span class=o>=</span> <span class=n>DataBaseClass</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=nb>id</span><span class=p>(</span><span class=n>db2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=mi>2018812627592</span>
</span></span><span class=line><span class=cl><span class=mi>2018812627592</span>    <span class=c1># 只创建了一次实例对象</span>
</span></span></code></pre></div><p>如果子类继承父类并且不改写<code>__new__</code>方法，则子类也保持单例模式。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>SingleCase</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>__instance</span> <span class=o>=</span> <span class=kc>None</span>       <span class=c1># 储存唯一实例化对象</span>
</span></span><span class=line><span class=cl>    <span class=n>__hasInit</span> <span class=o>=</span> <span class=kc>False</span>       <span class=c1># 标记是否进行初始化</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>age</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>SingleCase</span><span class=o>.</span><span class=n>__hasInit</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>age</span> <span class=o>=</span> <span class=n>age</span>
</span></span><span class=line><span class=cl>            <span class=n>SingleCase</span><span class=o>.</span><span class=n>__hasInit</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>cls</span><span class=o>.</span><span class=n>__instance</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>cls</span><span class=o>.</span><span class=n>__instance</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>__instance</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>obj1</span> <span class=o>=</span> <span class=n>SingleCase</span><span class=p>(</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>obj2</span> <span class=o>=</span> <span class=n>SingleCase</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=nb>id</span><span class=p>(</span><span class=n>obj1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=nb>id</span><span class=p>(</span><span class=n>obj2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>obj1</span><span class=o>.</span><span class=n>age</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>obj2</span><span class=o>.</span><span class=n>age</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>2152476593352</span>
</span></span><span class=line><span class=cl><span class=mi>2152476593352</span>
</span></span><span class=line><span class=cl><span class=mi>18</span>
</span></span><span class=line><span class=cl><span class=mi>18</span>                 <span class=c1># 实际上是同一对象</span>
</span></span></code></pre></div><p>单例模式的应用场景：日志插入logger的操作，网站计数器，权限验证模块，Windows资源管理器，系统回收站，数据库连接池等。</p><h4 id=错误与异常处理>错误与异常处理<a hidden class=anchor aria-hidden=true href=#错误与异常处理>#</a></h4><p><code>except</code>在捕获异常时，要根据具体的错误类型。不需要在每一个可能出错的地方进行捕获，只要在合适的层次捕获即可，这一可以大大减少写<code>try-except</code>语句的麻烦。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 可能出现错误的代码块</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>IndexError</span> <span class=k>as</span> <span class=n>ei</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>ei</span><span class=p>)</span>    <span class=c1># 出错后执行的代码块</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>ZeroDivisionError</span> <span class=k>as</span> <span class=n>ez</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>ez</span><span class=p>)</span>    <span class=c1># 出错后执行的代码块</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>msg</span><span class=p>:</span>  <span class=c1># 异常类型不确定时，Exception可以捕获所有类型异常</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 没有出错时执行的代码块</span>
</span></span><span class=line><span class=cl><span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 不论是否出错都执行的代码块</span>
</span></span></code></pre></div><p>其实python的解释器在抛出异常后，虽然整个程序终止，但是会有错误信息的提示和跟踪信息，从上到下对应了错误发生的层次顺序（错误的堆栈），根据这个跟踪信息顺序可以发现问题所在。</p><h4 id=自定义异常>自定义异常<a hidden class=anchor aria-hidden=true href=#自定义异常>#</a></h4><p>自定义异常都要直接或间接继承<code>Error</code>或<code>Exception</code>类。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyException</span><span class=p>(</span><span class=ne>Exception</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=nb>len</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_len</span> <span class=o>=</span> <span class=nb>len</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;Exception: Input with </span><span class=si>{}</span><span class=s1>, too long!&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_len</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>username</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;Input username (less than 6 characters)... &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>name</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>6</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>MyException</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>MyException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Program finished...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>username</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Input</span> <span class=n>username</span> <span class=p>(</span><span class=n>less</span> <span class=n>than</span> <span class=mi>6</span> <span class=n>characters</span><span class=p>)</span><span class=o>...</span> <span class=n>zachzhu</span>
</span></span><span class=line><span class=cl><span class=ne>Exception</span><span class=p>:</span> <span class=n>Input</span> <span class=k>with</span> <span class=mi>7</span><span class=p>,</span> <span class=n>too</span> <span class=n>long</span><span class=err>!</span>
</span></span><span class=line><span class=cl><span class=n>Program</span> <span class=n>finished</span><span class=o>...</span>
</span></span></code></pre></div><h4 id=动态绑定属性与方法>动态绑定属性与方法<a hidden class=anchor aria-hidden=true href=#动态绑定属性与方法>#</a></h4><p>动态语言即运行时可以改变结构的语言，例如增加新的函数、对象甚至代码，已有的函数可以被删除或是做其他结构上的改变。PHP、JavaScript和Python都是动态语言，而C、C#和Java是静态语言。因此Python可以在程序运行过程中添加属性和方法。</p><h4 id=动态添加方法>动态添加方法<a hidden class=anchor aria-hidden=true href=#动态添加方法>#</a></h4><p>动态添加实例方法需要引入<code>types</code>库：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>types</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dynamic_method</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{}</span><span class=s1> is from </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>Student</span><span class=o>.</span><span class=n>school</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 类的定义...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>za</span> <span class=o>=</span> <span class=n>Student</span><span class=p>(</span><span class=s1>&#39;Zach&#39;</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Student</span><span class=o>.</span><span class=n>school</span> <span class=o>=</span> <span class=s1>&#39;Hust&#39;</span>   <span class=c1># 动态绑定类属性</span>
</span></span><span class=line><span class=cl><span class=n>za</span><span class=o>.</span><span class=n>print_info</span> <span class=o>=</span> <span class=n>types</span><span class=o>.</span><span class=n>MethodType</span><span class=p>(</span><span class=n>dynamic_method</span><span class=p>,</span> <span class=n>za</span><span class=p>)</span>    <span class=c1># 动态方法的绑定</span>
</span></span><span class=line><span class=cl><span class=n>za</span><span class=o>.</span><span class=n>print_info</span><span class=p>()</span>   <span class=c1># 调用绑定的动态方法</span>
</span></span></code></pre></div><p>绑定类方法(静态方法同理)：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>class_test</span><span class=p>(</span><span class=bp>cls</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;This is a class method.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Student</span><span class=o>.</span><span class=n>test_method</span> <span class=o>=</span> <span class=n>class_test</span>
</span></span><span class=line><span class=cl><span class=n>Student</span><span class=o>.</span><span class=n>test_method</span><span class=p>()</span>
</span></span></code></pre></div><h4 id=__slots__属性><code>__slots__</code>属性<a hidden class=anchor aria-hidden=true href=#__slots__属性>#</a></h4><p>Python是动态语言，在运行时可以动态添加属性。如果要限制在运行时给类添加属性，Python允许在定义class的时候，定义一个特殊的<code>__slots__</code>变量，来限制该class实例能添加的属性。只有在<code>__slots__</code>变量中的属性才能被添加。<code>__slots__</code>属性子类不会继承，只有在当前类中有效，但是当子类声明<code>__slots__</code>时，其范围是子类加父类。比如<code>__slots__ = ()</code>表示直接继承父类属性。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Student</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=vm>__slots__</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>za</span> <span class=o>=</span> <span class=n>Student</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>za</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Zach&#39;</span>
</span></span><span class=line><span class=cl><span class=n>za</span><span class=o>.</span><span class=n>age</span> <span class=o>=</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>za</span><span class=o>.</span><span class=n>score</span> <span class=o>=</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl><span class=ne>AttributeError</span><span class=p>:</span> <span class=s1>&#39;Student&#39;</span> <span class=nb>object</span> <span class=n>has</span> <span class=n>no</span> <span class=n>attribute</span> <span class=s1>&#39;score&#39;</span>
</span></span></code></pre></div><p>不定义<code>__slots__</code>变量时，所有的属性都会储存在<code>za.__dict__</code>属性当中，不足之处在于占用内存较大，而定义了<code>__slots__</code>之后，实例中不存在<code>__dict__</code>属性。因此<code>__slots__</code>属性可以<strong>节约内存空间</strong>。</p><h3 id=day10-oop-project>Day10 OOP Project<a hidden class=anchor aria-hidden=true href=#day10-oop-project>#</a></h3><h3 id=day11-file-operations-and-modules>Day11 File Operations And Modules<a hidden class=anchor aria-hidden=true href=#day11-file-operations-and-modules>#</a></h3><h4 id=文件读写>文件读写<a hidden class=anchor aria-hidden=true href=#文件读写>#</a></h4><p>在Python中打开文件使用open函数，可以打开一个已经存在的文件，或者创建一个新文件，其语法格式为<code>open('filename', 'mode')</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>file_obj</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./Python_review/test.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>   
</span></span><span class=line><span class=cl><span class=c1># &#39;./&#39;表示在当前目录下</span>
</span></span><span class=line><span class=cl><span class=n>file_obj</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;hate it...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>file_obj</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><p>&lsquo;w&rsquo;模式每次会创建新文件，如果文件已存在则会将其覆盖，&lsquo;a&rsquo;模式表示在已存在文件的末尾追加。注意<strong>有中文的时候一定要说明编码方式，否则容易乱码/报错</strong>，VsCode Python的默认编码是<strong>utf-8</strong>(窗口右下角可调&mldr;)，编码方式在<code>open</code>语句中以<code>encoding=</code>属性进行设置。</p><p>&lsquo;wb&rsquo;表示以二进制格式打开一个文件用于写入：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>file_obj</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./Python_review/test.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>file_obj</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;hate it...&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>  <span class=c1># 将str类型转换为一个bytes类型</span>
</span></span><span class=line><span class=cl><span class=n>file_obj</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><p>二进制读写时要特别注意编码问题，应当在写入时做<code>'string'.encode('utf-8')</code>处理，而在读取时做<code>(fileObject.read()).decode('utf-8')</code>处理。</p><p>文件的读取：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./Python_review/test.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>        <span class=c1># 读取整个文件</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>4</span><span class=p>))</span>   <span class=c1># 读取4个字符，并将光标移动到读取的末尾，下次读取会从此继续</span>
</span></span><span class=line><span class=cl><span class=n>hell</span>
</span></span><span class=line><span class=cl><span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>              <span class=c1># 对文件和内存的安全非常必要</span>
</span></span></code></pre></div><p><code>.readline()</code>一次读取一行数据，以<code>\n</code>结尾；<code>.readlines()</code>读取整个文件返回一个列表，列表元素对应每一行的内容。</p><p>可以用<code>with</code>语句管理文件对象，可以自动释放打开关联的对象，可以免去<code>.close()</code>语句。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./Python_review/test.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Python Done Wrong&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>r/w适用于普通的读/写场景；+代表打开一个文件进行更新(可读可写)；w/w+/wb+每次都会创建一个新的文件，目录相同时则替换原文件；b代表二进制读写，rb/rb+适用于图片、音频、视频等类别的文件读取；a/ab/a+在原有文件的基础之后去文件指针的末尾进行追加。</p><h4 id=文件读写的应用实例>文件读写的应用实例<a hidden class=anchor aria-hidden=true href=#文件读写的应用实例>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>copy_file</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 对原文件进行备份</span>
</span></span><span class=line><span class=cl>    <span class=n>fileName</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;Input original filename: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>temp</span> <span class=o>=</span> <span class=n>fileName</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>copyName</span> <span class=o>=</span> <span class=n>temp</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;_copy.&#39;</span> <span class=o>+</span> <span class=n>temp</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>of</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>fileName</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>cf</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>copyName</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 注意有中文的时候一定要说明编码方式，否则容易报错</span>
</span></span><span class=line><span class=cl>    <span class=n>content</span> <span class=o>=</span> <span class=n>of</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>of</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cf</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>copy_file</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Type</span> <span class=ow>in</span> <span class=n>the</span> <span class=n>original</span> <span class=n>filename</span><span class=p>:</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>Python_review</span>\<span class=n>test</span><span class=o>.</span><span class=n>txt</span>
</span></span></code></pre></div><p>处理超大文件时，一次将全部内容读出会占据大量的内存，因此针对大文件读取可以做出以下改进：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>copy_file</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>fileName</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;Input original filename: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>temp</span> <span class=o>=</span> <span class=n>fileName</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>copyName</span> <span class=o>=</span> <span class=n>temp</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;_copy.&#39;</span> <span class=o>+</span> <span class=n>temp</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>fileName</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>of</span><span class=p>,</span> \
</span></span><span class=line><span class=cl>        <span class=nb>open</span><span class=p>(</span><span class=n>copyName</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>cf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># space+\换行符</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>content</span> <span class=o>=</span> <span class=n>of</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>cf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>content</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>1024</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=文件定位>文件定位<a hidden class=anchor aria-hidden=true href=#文件定位>#</a></h4><p>文件定位指当前文件指针读取到的位置，可以使用<code>.tell()</code>方法来实现。utf-8编码中一个中文字符占3个字节，一个换行符占2个字节，因此<code>.tell()</code>方法返回的位置是3×中文字符数，2×换行符。</p><p><code>fileObject.truncate([size])</code>从文件的首行首字符开始截断，截断文件为size个字节，无size表示从当前位置截断；截断之后后面的所有字符被删除，其中windows系统下的<strong>换行代表2个字节大小</strong>。测试了一下，似乎<code>.read()</code>按照<code>open()</code>语句中的打开模式操作，&lsquo;b&rsquo;二进制模式下按照字节数操作，否则按字符数操作；而<code>.truncate()</code>始终按字节数进行操作。</p><p>在操作文件的过程中，如果需要定位到其他位置进行操作，用<code>.seek()</code>方法。<code>fileObject.seek(offset[, whence])</code>有两个参数：</p><ul><li>offset：开始的偏移量，也就是代表需要移动偏移的<strong>字节数</strong>，如果是负数表示从倒数第几位开始。</li><li>whence：可选，默认值为0。给offset定义一个参数，表示要从哪个位置开始偏移；0代表从文件开头开始算起，1代表从当前位置开始算起，2代表从文件末尾算起。没有使用&rsquo;b&rsquo;二进制选项打开时，只允许从文件的开头计算。</li></ul><p>综上，文件定位的函数都是<strong>基于字节数</strong>进行的操作，进行文件定位操作时最好使用&rsquo;b&rsquo;二进制读写模式。</p><h4 id=模块导入方式>模块导入方式<a hidden class=anchor aria-hidden=true href=#模块导入方式>#</a></h4><p>Python有强大的第三方库，提供很多常用功能内置模块。简单来说模块就是封装了许多函数的.py文件。在程序中需要用到模块需先将模块导入。模块导入格式<code>import ModuleName</code>，函数调用格式<code>ModuleName.function_name()</code>。</p><p>当解释器遇到<code>import</code>关键字时，会优先搜索当前目录下；若当前目录下不存在时，则会到环境变量中搜索；环境变量中不存在时会在第三方模块安装位置<code>'C:\Program Files\Python37\Lib\site-packages'</code>中搜索。可以使用<code>sys</code>模块中的<code>path</code>变量查看搜索路径。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>ctime</span>     <span class=c1># 从模块中导入函数</span>
</span></span><span class=line><span class=cl><span class=n>ctime</span><span class=p>()</span>                    <span class=c1># 无需模块名前缀</span>
</span></span></code></pre></div><p>可以用<code>import ModuleName as ...</code>语句，自定义程序中指向模块名称空间的变量。</p><h4 id=os模块操作文件>os模块操作文件<a hidden class=anchor aria-hidden=true href=#os模块操作文件>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 基本目录操作，新建、删除、重命名</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=s1>&#39;test.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;test_rename.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=s1>&#39;test.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=s1>&#39;os_test&#39;</span><span class=p>)</span>          <span class=c1># 在当前位置创建目录</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>rmdir</span><span class=p>(</span><span class=s1>&#39;os_test&#39;</span><span class=p>)</span>          <span class=c1># 只能删除空目录</span>
</span></span><span class=line><span class=cl><span class=c1># 删除非空目录需要导入shutil.remove()</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=s1>&#39;d:/test&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=s1>&#39;d:/test/Sub&#39;</span><span class=p>)</span>      <span class=c1># 一次只能创建一级目录</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=s1>&#39;d:/test1/ha&#39;</span><span class=p>)</span>   <span class=c1># 可以创建多级</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 目录获取与拼接</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>()</span>              <span class=c1># 获取当前的目录</span>
</span></span><span class=line><span class=cl><span class=n>C</span><span class=p>:</span>\<span class=n>Users</span>\<span class=mi>12035</span>\<span class=n>VScodeProjects</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>(),</span> <span class=s1>&#39;Python_review&#39;</span><span class=p>)</span>   <span class=c1># 路径的拼接</span>
</span></span><span class=line><span class=cl><span class=n>C</span><span class=p>:</span>\<span class=n>Users</span>\<span class=mi>12035</span>\<span class=n>VScodeProjects</span>\<span class=n>Python_review</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 目录列表的获取</span>
</span></span><span class=line><span class=cl><span class=c1># 方法1</span>
</span></span><span class=line><span class=cl><span class=n>listD</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=s1>&#39;d:/&#39;</span><span class=p>)</span>    <span class=c1># 取出该位置所有目录名储存在列表中</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>dirName</span> <span class=ow>in</span> <span class=n>listD</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>dirName</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 方法2</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>os</span><span class=o>.</span><span class=n>scandir</span><span class=p>(</span><span class=s1>&#39;d:/&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>entries</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 用with语句，在完成迭代后自动释放资源</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>entry</span> <span class=ow>in</span> <span class=n>entries</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>entry</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span></span></code></pre></div><p>文件操作的综合运用见<strong>Day5 Function Ⅱ > 递归函数</strong>。</p><h4 id=模块的制作>模块的制作<a hidden class=anchor aria-hidden=true href=#模块的制作>#</a></h4><p>在Python中一个.py文件即是一个模块。模块可以是我们有逻辑地去组织Python代码，以库的形式去封装功能，方便使用者调用。</p><p>当Module中含有函数外的语句时，被导入时也会被运行，因此可以借助魔术变量<code>__name__</code>解决这个问题。当模块自身被运行时<code>__name__</code>为 <code>'__main__'</code>，而被导入时为模块名，因此可以在模块中的测试语句前加入判断语句<code>if __name__ == '__main__':</code>，那么模块被导入时测试语句不会被运行。</p><p>模块中<code>__all__</code>魔术变量限定<code>from ModuleName import *</code>导入方式时可以导入的方法。使用格式为<code>__all__ = ['functionName1', 'functionName2', ...]</code>。</p><h4 id=模块的发布>模块的发布<a hidden class=anchor aria-hidden=true href=#模块的发布>#</a></h4><ul><li>将写好的模块拉到一个单独的目录下，在该目录下建立一个setup.py文件：</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>distutils.core</span> <span class=kn>import</span> <span class=n>setup</span>
</span></span><span class=line><span class=cl><span class=c1># name模块名称</span>
</span></span><span class=line><span class=cl><span class=c1># version版本号</span>
</span></span><span class=line><span class=cl><span class=c1># description描述</span>
</span></span><span class=line><span class=cl><span class=c1># author作者</span>
</span></span><span class=line><span class=cl><span class=c1># py_modules要发布的内容</span>
</span></span><span class=line><span class=cl><span class=n>setup</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;Arith&#39;</span><span class=p>,</span> <span class=n>version</span><span class=o>=</span><span class=s1>&#39;1.0&#39;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s1>&#39;simple arithmetic operations&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>      <span class=n>author</span><span class=o>=</span><span class=s1>&#39;Zach&#39;</span><span class=p>,</span> <span class=n>py_modules</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;arithmetic&#39;</span><span class=p>])</span>
</span></span></code></pre></div><ul><li><p>在Terminal下使用<code>cd</code>命令进入新建的目录(使用<code>dir</code>命令可以查看当前的目录)，使用<code>python setup.py build</code>命令创建模块，此时会自动生成一个build文件夹，里面的lib文件夹会存放模块的.py文件。</p></li><li><p>仍然在当前新建目录的路径下面，使用命令：<code>python setup.py sdist</code>生成模块的压缩包，压缩包的名字是setup.py文件中的name名字；可以在当前路径下使用tree命令查看目录和目录结构，压缩包存放在自动生成的dist文件夹中。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>Users</span>\<span class=mi>12035</span>\<span class=n>VScodeProjects</span><span class=o>&gt;</span> <span class=n>cd</span> <span class=n>Arith</span>
</span></span><span class=line><span class=cl><span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>Users</span>\<span class=mi>12035</span>\<span class=n>VScodeProjects</span>\<span class=n>Arith</span><span class=o>&gt;</span> <span class=n>python</span> <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>Users</span>\<span class=mi>12035</span>\<span class=n>VScodeProjects</span>\<span class=n>Arith</span><span class=o>&gt;</span> <span class=n>python</span> <span class=n>setup</span><span class=o>.</span><span class=n>py</span> <span class=n>sdist</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div></li></ul><h4 id=模块的安装>模块的安装<a hidden class=anchor aria-hidden=true href=#模块的安装>#</a></h4><p>将压缩生成的&rsquo;.tar.gz&rsquo;文件复制到需要的目录下，然后在Terminal进入该目录，用<code>pip install ModuleName</code>语句即可安装。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>PS C:<span class=se>\U</span>sers<span class=se>\1</span>2035<span class=se>\V</span>ScodeProjects&gt; d:
</span></span><span class=line><span class=cl>PS D:<span class=se>\&gt;</span> dir
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>PS D:<span class=se>\&gt;</span> pip install Arith-1.0.tar.gz
</span></span></code></pre></div><h3 id=day12-python-garbage-collection>Day12 Python Garbage Collection<a hidden class=anchor aria-hidden=true href=#day12-python-garbage-collection>#</a></h3><p>电脑运行变慢时可以关闭不用的程序、结束部分进程或重启电脑，但是重启电脑的效果最为明显，这说明其他方法并不能完全释放内存资源，而垃圾回收就是使程序尽可能完全地释放内存资源。</p><h4 id=引用计数机制>引用计数机制<a hidden class=anchor aria-hidden=true href=#引用计数机制>#</a></h4><p>高级语言如Java，C#等都采用了垃圾收集机制。Python采用的是引用计数机制为主，标记-清除和分代收集两种机制为辅的策略。
Python中每个东西都是对象，其核心就是一个结构体：PyObject，PyObject中的ob_refcnt就是作为引用计数，当引用计数为0时，该对象生命就结束了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>sys</span><span class=o>.</span><span class=n>getrefcount</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>   <span class=c1># 在调用后会释放引用</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>sys</span><span class=o>.</span><span class=n>getrefcount</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>
</span></span></code></pre></div><h4 id=标记-清除机制>标记-清除机制<a hidden class=anchor aria-hidden=true href=#标记-清除机制>#</a></h4><p>首先标记对象（垃圾检测），然后清除垃圾（垃圾回收）。初始所有对象标记为白色，并确定根节点（这些对象是不会删除的），标记为黑色；将有效对象引用的对象标记为灰色，表示对象可达，但其引用的对象还未检查；检查完灰色都西昂引用的对象后其标记为黑色。重复该过程直到没有灰色节点为止。最后白色节点需要被清除。</p><h4 id=分代收集机制>分代收集机制<a hidden class=anchor aria-hidden=true href=#分代收集机制>#</a></h4><p>循环引用的情况难以被引用计数机制解决，因此需要其他GC机制。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>psutil</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>show_mem</span><span class=p>(</span><span class=n>tag</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>pid</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getpid</span><span class=p>()</span>            <span class=c1># 得到进程id</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>psutil</span><span class=o>.</span><span class=n>Process</span><span class=p>(</span><span class=n>pid</span><span class=p>)</span>      <span class=c1># 得到进程对象</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>memory_full_info</span><span class=p>()</span>  <span class=c1># 得到完整内存信息</span>
</span></span><span class=line><span class=cl>    <span class=n>memory</span> <span class=o>=</span> <span class=n>info</span><span class=o>.</span><span class=n>uss</span><span class=o>/</span><span class=mi>1024</span><span class=o>/</span><span class=mi>1024</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{}</span><span class=s1> memory used: </span><span class=si>{}</span><span class=s1>MB&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>tag</span><span class=p>,</span> <span class=n>memory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>show_mem</span><span class=p>(</span><span class=s1>&#39;initial&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100000</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100000</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>    <span class=c1># 循环引用</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(sys.getrefcount(a))</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(sys.getrefcount(b))</span>
</span></span><span class=line><span class=cl>    <span class=n>show_mem</span><span class=p>(</span><span class=s1>&#39;after creating a b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># del a</span>
</span></span><span class=line><span class=cl>    <span class=c1># del b</span>
</span></span><span class=line><span class=cl>    <span class=c1># 函数调用结束后相当于运行了以上语句，但引用始终不为0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>show_mem</span><span class=p>(</span><span class=s1>&#39;function ends&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>initial</span> <span class=n>memory</span> <span class=n>used</span><span class=p>:</span> <span class=mf>6.2109375</span><span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>after</span> <span class=n>creating</span> <span class=n>a</span> <span class=n>b</span> <span class=n>memory</span> <span class=n>used</span><span class=p>:</span> <span class=mf>21.52734375</span><span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=n>function</span> <span class=n>ends</span> <span class=n>memory</span> <span class=n>used</span><span class=p>:</span> <span class=mf>21.52734375</span><span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>gc</span><span class=o>.</span><span class=n>collect</span><span class=p>()</span>    <span class=c1># 手动释放内存</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>show_mem</span><span class=p>(</span><span class=s1>&#39;function ends&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>initial</span> <span class=n>memory</span> <span class=n>used</span><span class=p>:</span> <span class=mf>6.2578125</span><span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>after</span> <span class=n>creating</span> <span class=n>a</span> <span class=n>b</span> <span class=n>memory</span> <span class=n>used</span><span class=p>:</span> <span class=mf>21.5859375</span><span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=n>function</span> <span class=n>ends</span> <span class=n>memory</span> <span class=n>used</span><span class=p>:</span> <span class=mf>6.28515625</span><span class=n>MB</span>
</span></span></code></pre></div><p>由于循环引用，并且程序使用了一些比其他对象存在更久的对象，从而被分配对象的计数值与被释放对象的计数值差异累积超过某个<strong>GC阈值</strong>，此时Python的收集机制就启动了，触发所谓零代算法。
零代算法：Python使用一种不同的链表来持续追踪活跃的对象，每创建一个对象时Python将其加入零代链表，Generation Zero；Python循环遍历零代链表上的每个对象检查其相互引用情况，依据规则减掉引用计数，引用计数为0的对象可以被释放，而不为0则代表着其正在被零代链表之外的对象引用，即其相对活跃；剩下的活跃对象被移动到新的链表，一代链表；一代链表中对象的处理方式同理。
通过这种方法，持续访问的活跃对象会从零代链表到一代再到二代，而所谓的浮动垃圾则会每隔一段时间被处理。</p><h4 id=python中的gc模块>Python中的GC模块<a hidden class=anchor aria-hidden=true href=#python中的gc模块>#</a></h4><p>当gc模块的计数器达到阈值时，会自动回收垃圾（除非使用<code>gc.disable()</code>关闭gc模块功能）；<code>gc.collect()</code>可以手动回收垃圾；程序退出时，python解释器会自动回收垃圾。</p><p><code>gc.get_count()</code>可以获取一个长度为3的列表的计数器，例如(200, 8, 3)，200表示距离上一次一代垃圾检查，python分配内存数目减去释放内存的数目；8是指距离上一次二代垃圾检查，一代垃圾检查的次数，3同理。<code>gc.get_threshold()</code>可以获取分带收集机制的GC阈值。</p><p>Python的小整数与大整数对象池：Python为了避免整数频繁申请和销毁内存空间，[-5, 256]这些整数对象是提前建立好的，不会被垃圾回收。</p><h4 id=python-pep8规范>Python PEP8规范<a hidden class=anchor aria-hidden=true href=#python-pep8规范>#</a></h4><p>每一行的最大长度为79，换行可以使用<code>space+\</code>，圆括号内则不需要换行符。文本长块，如文档字符串或注释的行长度应限制为72个字符。</p><p>模块名要简短，使用小写字母，下划线提高可读性；包名和模块名类似，但不推荐下划线。类名称通常使用大驼峰命名方式。实例方法总是用self作为第一个参数，类方法总是用cls作为第一个参数。函数名和实例变量使用小写字母，下划线分隔提高可读性。</p><h4 id=命令行参数>命令行参数<a hidden class=anchor aria-hidden=true href=#命令行参数>#</a></h4><p>在使用Python开发脚本，作为一个运维工具，或者其他工具需要用户参数运行时，可以用到命令行传参的方式。Python可以用sys模块中的<code>sys.argv</code>获取命令行参数。argv返回的第一个元素为py文件的文件名（包含完整路径），不需文件名可直接使用切片[1:]。</p><p>argparse模块可以轻松编写用户友好的命令行界面：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>argparse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 创建一个解析器对象</span>
</span></span><span class=line><span class=cl><span class=c1># prog -- The name of the program (default: sys.argv[0])</span>
</span></span><span class=line><span class=cl><span class=c1># usage -- A usage message (default: auto-generated from arguments)</span>
</span></span><span class=line><span class=cl><span class=c1># description -- A description of what the program does</span>
</span></span><span class=line><span class=cl><span class=c1># epilog -- Text following the argument descriptions</span>
</span></span><span class=line><span class=cl><span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>(</span><span class=n>prog</span><span class=o>=</span><span class=s1>&#39;my-program&#39;</span><span class=p>,</span> <span class=n>usage</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(prog)s</span><span class=s1> [options] usage&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                <span class=n>description</span><span class=o>=</span><span class=s1>&#39;my-description&#39;</span><span class=p>,</span> <span class=n>epilog</span><span class=o>=</span><span class=s1>&#39;my-epilog&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 添加位置参数(必选参数)</span>
</span></span><span class=line><span class=cl><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;your own name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;your age&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 添加可选参数</span>
</span></span><span class=line><span class=cl><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-g&#39;</span><span class=p>,</span> <span class=s1>&#39;--gender&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;your sexuality&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 可以增加属性action=&#39;append&#39;，则可以从命令行重复定义该参数，变量空间中以列表储存</span>
</span></span><span class=line><span class=cl><span class=c1># 可以增加属性default=&#39;Male&#39;指定默认值，choices=[&#39;Male&#39;, &#39;Female&#39;]限定参数的范围</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 开始解析参数并打印</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>     
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 可以通过result.name...访问具体的变量</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 直接在Terminal进行如下操作</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>Users</span>\<span class=mi>12035</span>\<span class=n>VScodeProjects</span><span class=o>&gt;</span> <span class=n>python</span> <span class=n>c</span><span class=p>:</span><span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=mi>12035</span><span class=o>/</span><span class=n>VScodeProjects</span><span class=o>/</span><span class=n>Python_review</span><span class=o>/</span><span class=n>sys_test</span><span class=o>.</span><span class=n>py</span> <span class=n>Zach</span> <span class=mi>20</span> <span class=o>-</span><span class=n>g</span> <span class=n>Male</span>
</span></span><span class=line><span class=cl><span class=n>Namespace</span><span class=p>(</span><span class=n>age</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>gender</span><span class=o>=</span><span class=s1>&#39;Male&#39;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;Zach&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>Users</span>\<span class=mi>12035</span>\<span class=n>VScodeProjects</span><span class=o>&gt;</span> <span class=n>python</span> <span class=n>c</span><span class=p>:</span><span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=mi>12035</span><span class=o>/</span><span class=n>VScodeProjects</span><span class=o>/</span><span class=n>Python_review</span><span class=o>/</span><span class=n>sys_test</span><span class=o>.</span><span class=n>py</span> <span class=o>-</span><span class=n>h</span>
</span></span><span class=line><span class=cl><span class=n>usage</span><span class=p>:</span> <span class=n>my</span><span class=o>-</span><span class=n>program</span> <span class=p>[</span><span class=n>options</span><span class=p>]</span> <span class=n>usage</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>my</span><span class=o>-</span><span class=n>description</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>positional</span> <span class=n>arguments</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span>                  <span class=n>your</span> <span class=n>own</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>  <span class=n>age</span>                   <span class=n>your</span> <span class=n>age</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>optional</span> <span class=n>arguments</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>h</span><span class=p>,</span> <span class=o>--</span><span class=n>help</span>            <span class=n>show</span> <span class=n>this</span> <span class=n>help</span> <span class=n>message</span> <span class=ow>and</span> <span class=n>exit</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>g</span> <span class=n>GENDER</span><span class=p>,</span> <span class=o>--</span><span class=n>gender</span> <span class=n>GENDER</span>
</span></span><span class=line><span class=cl>                        <span class=n>your</span> <span class=n>sexuality</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>my</span><span class=o>-</span><span class=n>epilog</span>
</span></span></code></pre></div><h3 id=day13-python-regular-expression>Day13 Python Regular Expression<a hidden class=anchor aria-hidden=true href=#day13-python-regular-expression>#</a></h3><h4 id=正则表达式概述>正则表达式概述<a hidden class=anchor aria-hidden=true href=#正则表达式概述>#</a></h4><p>正则表达式是一个特殊的字符序列，它能帮助你方便的检查一个字符串是否与某种模式匹配。Python自1.5版本起增加了re模块，它提供Perl风格的正则表达式模式。re模块使Python语言拥有全部的正则表达式功能。compile函数根据一个模式字符串和可选的标志参数生成一个正则表达式对象。该对象拥有一系列方法用于正则表达式匹配和替换。re模块也提供了与这些方法功能完全一致的函数，这些函数使用一个模式字符串做为它们的第一个参数。</p><h4 id=python-re模块>Python re模块<a hidden class=anchor aria-hidden=true href=#python-re模块>#</a></h4><p><code>re.match(pattern, string, flags=0)</code>尝试从<strong>字符串的起始位置</strong>匹配一个规则，匹配成功就返回match对象，否则返回None。可以用<code>group()</code>获取匹配成功的字符串。pattern-匹配的正则表达式，string-要匹配的字符串，flag-标志位，用于控制正则表达式的匹配方式，如是否区分大小写、多行匹配等。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;Python makes me happy~&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 精确匹配，且只匹配字符串的开头位置</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;python&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>I</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 此处可以是.match(&#39;p&#39;...)/.macth(&#39;P&#39;...)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>result</span><span class=o>.</span><span class=n>group</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;P&#39;</span>
</span></span></code></pre></div><p>flag可选的标志符：re.I-使匹配对大小写不敏感，re.M-多行匹配，影响^和$，如果使用多个标志位用|分隔，如<code>re.I|re.M</code>。</p><p>使用<code>group(num)</code>或<code>groups()</code>匹配对象函数来获取匹配表达式。<code>group(num=0)</code>返回匹配的整个表达式的字符串，可以一次输入多个组号，在这种情况下将返回一个包含那些组所对应值的元组。<code>groups()</code>返回一个包含所有小组字符串的元组，从1到所含的小组号。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;Python is the best language in the world&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># .* 表示任意匹配除换行符（\n、\r）之外的任何单个或多个字符</span>
</span></span><span class=line><span class=cl><span class=c1># (.*?) 表示&#34;非贪婪&#34;模式，只保存第一个匹配到的子串</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;(.*) is (.*?) .*&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>M</span><span class=o>|</span><span class=n>re</span><span class=o>.</span><span class=n>I</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>result</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>groups</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;No match!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>re</span><span class=o>.</span><span class=n>Match</span> <span class=nb>object</span><span class=p>;</span> <span class=n>span</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>40</span><span class=p>),</span> <span class=k>match</span><span class=o>=</span><span class=s1>&#39;Python is the best language in the world&#39;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=n>Python</span> <span class=ow>is</span> <span class=n>the</span> <span class=n>best</span> <span class=n>language</span> <span class=ow>in</span> <span class=n>the</span> <span class=n>world</span>
</span></span><span class=line><span class=cl><span class=n>Python</span>
</span></span><span class=line><span class=cl><span class=n>the</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=s1>&#39;Python&#39;</span><span class=p>,</span> <span class=s1>&#39;the&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=常用匹配规则>常用匹配规则<a hidden class=anchor aria-hidden=true href=#常用匹配规则>#</a></h4><p><code>.</code>的使用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>line</span> <span class=o>=</span> <span class=s1>&#39;aaaa&#39;</span>
</span></span><span class=line><span class=cl><span class=n>names</span> <span class=o>=</span> <span class=s1>&#39;李敏&#39;</span><span class=p>,</span> <span class=s1>&#39;李达&#39;</span><span class=p>,</span> <span class=s1>&#39;小李&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 一个&#39;.&#39;匹配除去换行符&#39;\n&#39;之外的一个字符</span>
</span></span><span class=line><span class=cl><span class=n>pattern</span> <span class=o>=</span> <span class=s1>&#39;..&#39;</span>
</span></span><span class=line><span class=cl><span class=n>pattern1</span> <span class=o>=</span> <span class=s1>&#39;李.&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;No match!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>names</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>res1</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>pattern1</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>res1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>res1</span><span class=o>.</span><span class=n>group</span><span class=p>(),</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>aa</span>
</span></span><span class=line><span class=cl><span class=n>李敏</span> <span class=n>李达</span> 
</span></span></code></pre></div><p><code>[]</code>的使用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;echo&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 使用中括号表示一个集合，匹配集合内的任一字符</span>
</span></span><span class=line><span class=cl><span class=c1># matchObject = re.match(&#39;[ace]&#39;, str)  # 匹配字母a c e</span>
</span></span><span class=line><span class=cl><span class=n>matchObject</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;[a-e]&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span>    <span class=c1># 匹配字母a到e</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>matchObject</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>matchObject</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;No match!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>e</span>
</span></span></code></pre></div><table><thead><tr><th style=text-align:left>Pattern</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>\d</td><td style=text-align:left>匹配任意一位数字，相当于&rsquo;[0-9]&rsquo;</td></tr><tr><td style=text-align:left>\d&rsquo;*num</td><td style=text-align:left>匹配前num位数字</td></tr><tr><td style=text-align:left>\D</td><td style=text-align:left>匹配任意一位非数字</td></tr><tr><td style=text-align:left>\s</td><td style=text-align:left>匹配任意一个空白字符或tab键 等价于 [\t\n\r\f]</td></tr><tr><td style=text-align:left>\S</td><td style=text-align:left>匹配任意非空字符</td></tr><tr><td style=text-align:left>\w</td><td style=text-align:left>匹配数字字母下划线</td></tr><tr><td style=text-align:left>\W</td><td style=text-align:left>匹配非数字字母下划线</td></tr></tbody></table><h4 id=匹配字符数量>匹配字符数量<a hidden class=anchor aria-hidden=true href=#匹配字符数量>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># *表示匹配前一个字符出现0次或无限次，即可有可无</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;[A-Z][A-Z]*&#39;</span><span class=p>,</span> <span class=s1>&#39;Ay&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># A</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;[A-Z][a-z]*&#39;</span><span class=p>,</span> <span class=s1>&#39;AnythingYouKnow&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># Anything</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># +表示匹配前一个字符至少出现一次</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;[A-Z]+&#39;</span><span class=p>,</span> <span class=s1>&#39;MYname&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># MY</span>
</span></span><span class=line><span class=cl><span class=c1># 匹配符合python变量命名规范的字符串(不能以数字开头，只包含数字字母下划线)</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;[a-zA-Z_]+[\w]*&#39;</span><span class=p>,</span> <span class=s1>&#39;_name11&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># _name11</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ?表示匹配前一个字符出现1次或0次，即要么有要么没有</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;[a-zA-Z_]+\d?&#39;</span><span class=p>,</span> <span class=s1>&#39;name11&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># name1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># {min,max}表示匹配前一个字符次数范围</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;\d</span><span class=si>{4}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=s1>&#39;11230&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># 1123</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;\d{4,}&#39;</span><span class=p>,</span> <span class=s1>&#39;11230&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># 11230</span>
</span></span><span class=line><span class=cl><span class=c1># 匹配邮箱</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;[a-zA-Z0-9]{6,11}@gmail.com&#39;</span><span class=p>,</span> <span class=s1>&#39;zachary99@gmail.com&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># zachary99@gmail.com</span>
</span></span></code></pre></div><h4 id=转义开头和结尾>转义、开头和结尾<a hidden class=anchor aria-hidden=true href=#转义开头和结尾>#</a></h4><p>python字符串中<code>\</code>作为转义字符开头，比如<code>\t</code>表示tab键，<code>\n</code>表示换行，为了表示<code>'\'</code>本身，比如在打印路径时应再加一个<code>\</code>形成<code>'\\'</code>的形式。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>myPath</span> <span class=o>=</span> <span class=s1>&#39;G:\py_note</span><span class=se>\1</span><span class=s1>-syntax&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>myPath</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># G:\py_note-syntax</span>
</span></span><span class=line><span class=cl><span class=n>myPath</span> <span class=o>=</span> <span class=s1>&#39;G:</span><span class=se>\\</span><span class=s1>py_note</span><span class=se>\\</span><span class=s1>1-syntax&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>myPath</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># G:\py_note\1-syntax</span>
</span></span></code></pre></div><p>正则表达式中的<code>\</code>也需要转移，因此为匹配并输出正确的路径，应当为<code>\\</code>载进行转义。也可以通过在pattern前加上<code>r</code>表示原生字符串直接匹配，不进行转义。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;c:</span><span class=se>\\\\</span><span class=s1>a.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;c:</span><span class=se>\\</span><span class=s1>a.txt&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># c:\a.txt</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;c:</span><span class=se>\\</span><span class=s1>a.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;c:</span><span class=se>\\</span><span class=s1>a.txt&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># c:\a.txt</span>
</span></span></code></pre></div><p>字符串开头结尾的匹配：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ^表示匹配字符串的开头</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;^P.*&#39;</span><span class=p>,</span> <span class=s1>&#39;Python done right.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># Python done right.</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;^P\w</span><span class=si>{5}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=s1>&#39;Python done right.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># Python</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># $表示匹配字符串的结尾</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;\w{5,15}@\w{2,6}.com$&#39;</span><span class=p>,</span> <span class=s1>&#39;1203524576@qq.com&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># 1203524576@qq.com</span>
</span></span></code></pre></div><h4 id=分组匹配>分组匹配<a hidden class=anchor aria-hidden=true href=#分组匹配>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># |表示匹配左右任意一个表达式</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;100|[1-9]\d?&#39;</span><span class=p>,</span> <span class=s1>&#39;100&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 100需放在前面，否则匹配出10，或改用表达式&#39;[1-9]?\d$|100&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># 100</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ()表示将字符作为一个分组</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;(\d+)-(\d+)&#39;</span><span class=p>,</span> <span class=s1>&#39;027-82411110&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 匹配带区号的电话号码</span>
</span></span><span class=line><span class=cl><span class=c1># 或使用表达式&#39;([^-]+)-(\d+)&#39;，在[]中^表示取反，即不是^的字符</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># 027-82411110</span>
</span></span><span class=line><span class=cl><span class=c1># 027</span>
</span></span><span class=line><span class=cl><span class=c1># 82411110</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># \num表示引用分组num匹配到的字符</span>
</span></span><span class=line><span class=cl><span class=n>htmlTag</span> <span class=o>=</span> <span class=s1>&#39;&lt;html&gt;&lt;h1&gt;test&lt;/h1&gt;&lt;/html&gt;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;&lt;(.+)&gt;&lt;(.+)&gt;(.+)&lt;/\2&gt;&lt;/\1&gt;&#39;</span><span class=p>,</span> <span class=n>htmlTag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># html</span>
</span></span><span class=line><span class=cl><span class=c1># h1</span>
</span></span><span class=line><span class=cl><span class=c1># test</span>
</span></span><span class=line><span class=cl><span class=c1># 分组过多时可读性差，可以使用分组别名(?P&lt;name&gt;...)和(?P=name)</span>
</span></span><span class=line><span class=cl><span class=n>htmlTag</span> <span class=o>=</span> <span class=s1>&#39;&lt;div&gt;&lt;h1&gt;www.google.com&lt;/h1&gt;&lt;/div&gt;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;&lt;(?P&lt;n1&gt;\w*)&gt;&lt;(?P&lt;n2&gt;\w*)&gt;(.+)&lt;/(?P=n2)&gt;&lt;/(?P=n1)&gt;&#39;</span><span class=p>,</span> <span class=n>htmlTag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># div</span>
</span></span><span class=line><span class=cl><span class=c1># h1</span>
</span></span><span class=line><span class=cl><span class=c1># www.google.com</span>
</span></span></code></pre></div><h4 id=re中的其他方法>re中的其他方法<a hidden class=anchor aria-hidden=true href=#re中的其他方法>#</a></h4><p>每次使用正则表达式进行match操作时，python会进行一次字符串转为正则表达式对象的操作。而进行**<code>re.compile()</code>**将正则表达式模式编译成一个正则表达式对象，其保存所产生的正则表达式对象重用效率更高。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=n>reObj</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=s1>&#39;\d</span><span class=si>{4}</span><span class=s1>&#39;</span><span class=p>)</span>   <span class=c1># reObj可重用</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>reObj</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;12306&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># 1230</span>
</span></span></code></pre></div><p><code>re.search()</code>在全文中匹配一次，匹配到就返回。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=n>line</span> <span class=o>=</span> <span class=s1>&#39;Python done right.&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s1>&#39;done&#39;</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># done</span>
</span></span></code></pre></div><p><code>re.findall()</code>匹配所有返回一个列表(查询正则表达式)。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=n>line</span> <span class=o>=</span> <span class=s1>&#39;西瓜和冬瓜&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;.瓜&#39;</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [&#39;西瓜&#39;, &#39;冬瓜&#39;]</span>
</span></span><span class=line><span class=cl><span class=n>reObj</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=s1>&#39;.瓜&#39;</span><span class=p>)</span>          <span class=c1># 创建对象便于复用</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>reObj</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>line</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>reObj</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=n>line</span><span class=p>))</span>
</span></span></code></pre></div><p><strong>使用<code>re.findall()</code>函数时要活用<code>'()'</code>，输出需要的内容：</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>line</span> <span class=o>=</span> <span class=s1>&#39;&lt;span&gt;Truman Show&lt;/span&gt;&lt;span&gt;Avatar&lt;/span&gt;&lt;span&gt;La La Land&lt;/span&gt;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>reObject</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;&lt;span&gt;(.+?)&lt;/span&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>reObject</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [&#39;Truman Show&#39;, &#39;Avatar&#39;, &#39;La La Land&#39;]</span>
</span></span></code></pre></div><p><code>re.sub(pattern, repl, string, count=0, flags=0)</code>将匹配到的数据进行替换。count为匹配后替换的最大次数，默认0表示替换所有，flags为正则表达式匹配方式的标志位。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=n>line</span> <span class=o>=</span> <span class=s1>&#39;Python是很受欢迎的语言.&#39;</span>
</span></span><span class=line><span class=cl><span class=n>pattern</span> <span class=o>=</span> <span class=s1>&#39;[a-zA-Z]+&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=s1>&#39;C#&#39;</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res_n</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>subn</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=s1>&#39;C#&#39;</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>     <span class=c1># 返回替换次数</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res_n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># C#是很受欢迎的语言.</span>
</span></span><span class=line><span class=cl><span class=c1># (&#39;C#是很受欢迎的语言.&#39;, 1)</span>
</span></span></code></pre></div><p><code>re.split()</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=n>line</span> <span class=o>=</span> <span class=s1>&#39;watermelon melon water&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [&#39;watermelon&#39;, &#39;melon&#39;, &#39;water&#39;]</span>
</span></span></code></pre></div><h4 id=贪婪模式与非贪婪模式>贪婪模式与非贪婪模式<a hidden class=anchor aria-hidden=true href=#贪婪模式与非贪婪模式>#</a></h4><p>Python里的数量词默认是贪婪的，即总是尝试匹配尽可能多的字符，非贪婪模式则相反，总是尝试匹配尽可能少的字符。在<code>*?+{m,n}</code>后面加上<code>?</code>使贪婪模式变为非贪婪。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 默认贪婪模式</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;\d{6,9}&#39;</span><span class=p>,</span> <span class=s1>&#39;1234567890&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># 加?变为非贪婪模式</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;\d{6,9}?&#39;</span><span class=p>,</span> <span class=s1>&#39;1234567890&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># 123456789</span>
</span></span><span class=line><span class=cl><span class=c1># 123456</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>line</span> <span class=o>=</span> <span class=s1>&#39;aacbacbc&#39;</span>
</span></span><span class=line><span class=cl><span class=n>reObject</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=s1>&#39;a.*b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>reObject</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># aacbacb</span>
</span></span><span class=line><span class=cl><span class=n>reObject</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=s1>&#39;a.*?b&#39;</span><span class=p>)</span>   <span class=c1># 加?变为非贪婪模式</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>reObject</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># aacb</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://zhuyimingg.github.io/tags/python/>Python</a></li><li><a href=https://zhuyimingg.github.io/tags/hugo/>Hugo</a></li></ul><nav class=paginav><a class=next href=https://zhuyimingg.github.io/posts/hello-my-site/><span class=title>Next »</span><br><span>Hello My Site</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://zhuyimingg.github.io/>Zach's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>